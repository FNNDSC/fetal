/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function i(a){throw a;}var m=void 0,n=!0,p=null,r=!1;function ca(){return function(){}}function da(a){return function(b){this[a]=b}}function s(a){return function(){return this[a]}}var t,ea=this;function fa(){}
function ha(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ia(a){return a!==m}function y(a){return a!=p}function z(a){return"array"==ha(a)}function ja(a){var b=ha(a);return"array"==b||"object"==b&&"number"==typeof a.length}function ka(a){return"string"==typeof a}function D(a){return"number"==typeof a}function la(a){return"function"==ha(a)}function ma(a){a=ha(a);return"object"==a||"array"==a||"function"==a}function na(a){return a[oa]||(a[oa]=++pa)}
var oa="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),pa=0;function qa(a,b,c){return a.call.apply(a.bind,arguments)}function ra(a,b,c){a||i(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ta(a,b,c){ta=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?qa:ra;return ta.apply(p,arguments)}function ua(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var wa=Date.now||function(){return+new Date};
function E(a,b){var c=a.split("."),d=ea;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ia(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function H(a,b){function c(){}c.prototype=b.prototype;a.i=b.prototype;a.prototype=new c;a.prototype.constructor=a};function xa(a,b,c){this.za=this.ya=this.xa=0;3==arguments.length?(this.xa=Number(a),this.ya=Number(b),this.za=Number(c)):a instanceof xa?(this.xa=Number(a.x()),this.ya=Number(a.y()),this.za=Number(a.b())):(this.xa=Number(a[0]),this.ya=Number(a[1]),this.za=Number(a[2]))}
xa.prototype={f:function(){return new xa(this.xa,this.ya,this.za)},Ye:function(){return new xa(-this.xa,-this.ya,-this.za)},uc:function(a){return new xa(this.xa+a.x(),this.ya+a.y(),this.za+a.b())},cd:function(a){return new xa(this.xa-a.x(),this.ya-a.y(),this.za-a.b())},Db:function(a){return new xa(this.xa*a,this.ya*a,this.za*a)},kh:function(a){return new xa(this.xa/a,this.ya/a,this.za/a)},rc:function(a){return this.xa*a.x()+this.ya*a.y()+this.za*a.b()},ig:function(a,b){return this.uc(a.cd(this).Db(b))},
length:function(){return Math.sqrt(this.rc(this))},kd:function(){return this.kh(this.length())},He:function(a){return new xa(this.ya*a.b()-this.za*a.y(),this.za*a.x()-this.xa*a.b(),this.xa*a.y()-this.ya*a.x())},x:s("xa"),y:s("ya"),b:s("za")};var I=I||{};I.Yi=n;I.Ga=function(a){eval("X.DEV === undefined")||window.console.time(a)};I.Aa=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.Ug=0;this.Ui=function(){return this.Ug++}};function ya(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&i(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.fd;++c)window.fd=window[b[c]+"RequestAnimationFrame"],window.Gd=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.fd||(window.fd=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=window.setTimeout(function(){b(c+f)},f);a=c+f;return g});window.Gd||(window.Gd=function(a){clearTimeout(a)})})();E("Function.prototype.bind",Function.prototype.bind);E("window.requestAnimationFrame",window.fd);
E("window.cancelAnimationFrame",window.Gd);function za(a){if(!Aa.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ba,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ca,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Da,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ga,"&quot;"));return a}var Ba=/&/g,Ca=/</g,Da=/>/g,Ga=/\"/g,Aa=/[&<>\"]/;var Ha,Ia,Ja,Ka,La,Ma,Na;function Oa(){return ea.navigator?ea.navigator.userAgent:p}function Pa(){return ea.navigator}La=Ka=Ja=Ia=Ha=r;var Qa;if(Qa=Oa()){var Ra=Pa();Ha=0==Qa.indexOf("Opera");Ia=!Ha&&-1!=Qa.indexOf("MSIE");Ka=(Ja=!Ha&&-1!=Qa.indexOf("WebKit"))&&-1!=Qa.indexOf("Mobile");La=!Ha&&!Ja&&"Gecko"==Ra.product}var Sa=Ha,K=Ia,Ta=La,Ua=Ja,Va=Ka,Wa,Xa=Pa();Wa=Xa&&Xa.platform||"";Ma=-1!=Wa.indexOf("Mac");Na=-1!=Wa.indexOf("Win");var Ya=!!Pa()&&-1!=(Pa().appVersion||"").indexOf("X11"),Za;
a:{var $a="",ab;if(Sa&&ea.opera)var bb=ea.opera.version,$a="function"==typeof bb?bb():bb;else if(Ta?ab=/rv\:([^\);]+)(\)|;)/:K?ab=/MSIE\s+([^\);]+)(\)|;)/:Ua&&(ab=/WebKit\/(\S+)/),ab)var cb=ab.exec(Oa()),$a=cb?cb[1]:"";if(K){var fb,gb=ea.document;fb=gb?gb.documentMode:m;if(fb>parseFloat($a)){Za=""+fb;break a}}Za=$a}var hb={};
function ib(a){var b;if(!(b=hb[a])){b=0;for(var c=(""+Za).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),k=RegExp("(\\d*)(\\D*)","g");do{var j=l.exec(g)||["","",""],o=k.exec(h)||["","",""];if(0==j[0].length&&0==o[0].length)break;b=((0==j[1].length?0:parseInt(j[1],10))<(0==o[1].length?0:parseInt(o[1],10))?-1:(0==j[1].length?0:parseInt(j[1],
10))>(0==o[1].length?0:parseInt(o[1],10))?1:0)||((0==j[2].length)<(0==o[2].length)?-1:(0==j[2].length)>(0==o[2].length)?1:0)||(j[2]<o[2]?-1:j[2]>o[2]?1:0)}while(0==b)}b=hb[a]=0<=b}return b}var jb={};function kb(a){return jb[a]||(jb[a]=K&&document.documentMode&&document.documentMode>=a)};function nb(a,b){for(var c in a)b.call(m,a[c],c,a)}function ob(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function pb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var qb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function rb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<qb.length;f++)c=qb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var sb=Array.prototype,tb=sb.indexOf?function(a,b,c){return sb.indexOf.call(a,b,c)}:function(a,b,c){c=c==p?0:0>c?Math.max(0,a.length+c):c;if(ka(a))return!ka(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},ub=sb.forEach?function(a,b,c){sb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ka(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},vb=sb.map?function(a,b,c){return sb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
ka(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},wb=sb.some?function(a,b,c){return sb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ka(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return n;return r},xb=sb.every?function(a,b,c){return sb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=ka(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return r;return n};function yb(a,b){var c=tb(a,b);0<=c&&sb.splice.call(a,c,1)}
function zb(a){return sb.concat.apply(sb,arguments)}function Ab(a){if(z(a))return zb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Bb(a,b,c){return 2>=arguments.length?sb.slice.call(a,b):sb.slice.call(a,b,c)};function Db(a){if("function"==typeof a.cb)a=a.cb();else if(ja(a)||ka(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Eb(a){if("function"==typeof a.Ma)return a.Ma();if(ka(a))return a.split("");if(ja(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return ob(a)}
function Fb(a,b){if("function"==typeof a.every)return a.every(b,m);if(ja(a)||ka(a))return xb(a,b,m);var c;if("function"==typeof a.Zc)c=a.Zc();else if("function"!=typeof a.Ma)if(ja(a)||ka(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=pb(a);else c=m;for(var d=Eb(a),e=d.length,f=0;f<e;f++)if(!b.call(m,d[f],c&&c[f],a))return r;return n};var Gb="StopIteration"in ea?ea.StopIteration:Error("StopIteration");function Hb(){}Hb.prototype.next=function(){i(Gb)};Hb.prototype.Ac=function(){return this};function Ib(a){if(a instanceof Hb)return a;if("function"==typeof a.Ac)return a.Ac(r);if(ja(a)){var b=0,c=new Hb;c.next=function(){for(;;){b>=a.length&&i(Gb);if(b in a)return a[b++];b++}};return c}i(Error("Not implemented"))}
function Jb(a,b){if(ja(a))try{ub(a,b,m)}catch(c){c!==Gb&&i(c)}else{a=Ib(a);try{for(;;)b.call(m,a.next(),m,a)}catch(d){d!==Gb&&i(d)}}};function Kb(a,b){this.D={};this.v=[];var c=arguments.length;if(1<c){c%2&&i(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.Ae(a)}t=Kb.prototype;t.L=0;t.ld=0;t.cb=s("L");t.Ma=function(){Lb(this);for(var a=[],b=0;b<this.v.length;b++)a.push(this.D[this.v[b]]);return a};t.Zc=function(){Lb(this);return this.v.concat()};t.Fe=function(a){for(var b=0;b<this.v.length;b++){var c=this.v[b];if(Mb(this.D,c)&&this.D[c]==a)return n}return r};
t.Vc=function(a,b){if(this===a)return n;if(this.L!=a.cb())return r;var c=b||Nb;Lb(this);for(var d,e=0;d=this.v[e];e++)if(!c(this.get(d),a.get(d)))return r;return n};function Nb(a,b){return a===b}t.clear=function(){this.D={};this.ld=this.L=this.v.length=0};t.remove=function(a){return Mb(this.D,a)?(delete this.D[a],this.L--,this.ld++,this.v.length>2*this.L&&Lb(this),n):r};
function Lb(a){if(a.L!=a.v.length){for(var b=0,c=0;b<a.v.length;){var d=a.v[b];Mb(a.D,d)&&(a.v[c++]=d);b++}a.v.length=c}if(a.L!=a.v.length){for(var e={},c=b=0;b<a.v.length;)d=a.v[b],Mb(e,d)||(a.v[c++]=d,e[d]=1),b++;a.v.length=c}}t.get=function(a,b){return Mb(this.D,a)?this.D[a]:b};t.set=function(a,b){Mb(this.D,a)||(this.L++,this.v.push(a),this.ld++);this.D[a]=b};t.Ae=function(a){var b;a instanceof Kb?(b=a.Zc(),a=a.Ma()):(b=pb(a),a=ob(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};t.f=function(){return new Kb(this)};
t.Ac=function(a){Lb(this);var b=0,c=this.v,d=this.D,e=this.ld,f=this,g=new Hb;g.next=function(){for(;;){e!=f.ld&&i(Error("The map has changed since the iterator was created"));b>=c.length&&i(Gb);var g=c[b++];return a?g:d[g]}};return g};function Mb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Ob(a){this.D=new Kb;a&&this.Ae(a)}function Pb(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+na(a):b.substr(0,1)+a}t=Ob.prototype;t.cb=function(){return this.D.cb()};t.add=function(a){this.D.set(Pb(a),a)};t.Ae=function(a){for(var a=Eb(a),b=a.length,c=0;c<b;c++)this.add(a[c])};t.Xd=function(a){for(var a=Eb(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};t.remove=function(a){return this.D.remove(Pb(a))};t.clear=function(){this.D.clear()};
t.contains=function(a){a=Pb(a);return Mb(this.D.D,a)};t.gg=function(a){for(var b=new Ob,a=Eb(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};t.Ma=function(){return this.D.Ma()};t.f=function(){return new Ob(this)};t.Vc=function(a){return this.cb()==Db(a)&&Qb(this,a)};
function Qb(a,b){var c=Db(b);if(a.cb()>c)return r;!(b instanceof Ob)&&5<c&&(b=new Ob(b));return Fb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.Fe)a=b.Fe(a);else if(ja(b)||ka(b))a=0<=tb(b,a);else a:{for(var c in b)if(b[c]==a){a=n;break a}a=r}return a})}t.Ac=function(){return this.D.Ac(r)};function Rb(){}Rb.prototype.Tf=r;Rb.prototype.La=function(){this.Tf||(this.Tf=n,this.M())};Rb.prototype.M=function(){this.hh&&Sb.apply(p,this.hh)};function Tb(a){a&&"function"==typeof a.La&&a.La()}function Sb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ja(d)?Sb.apply(p,d):Tb(d)}};function Ub(a,b){this.kg=b;this.Yc=[];a>this.kg&&i(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Yc.push(this.Id())}H(Ub,Rb);t=Ub.prototype;t.Qf=p;t.Sf=p;function Xb(a,b){a.Yc.length<a.kg?a.Yc.push(b):a.Ke(b)}t.Id=function(){return this.Qf?this.Qf():{}};t.Ke=function(a){if(this.Sf)this.Sf(a);else if(ma(a))if(la(a.La))a.La();else for(var b in a)delete a[b]};t.M=function(){Ub.i.M.call(this);for(var a=this.Yc;a.length;)this.Ke(a.pop());delete this.Yc};function Yb(){this.Wc=[];this.df=new Kb;this.Gg=this.Hg=this.Ig=this.Dg=0;this.jd=new Kb;this.Nf=this.Fg=0;this.Ze=1;this.Le=new Ub(0,4E3);this.Le.Id=function(){return new Zb};this.Eg=new Ub(0,50);this.Eg.Id=function(){return new $b};var a=this;this.Pe=new Ub(0,2E3);this.Pe.Id=function(){return""+a.Ze++};this.Pe.Ke=ca()}function $b(){this.rf=this.time=this.count=0}
$b.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.rf&&a.push(" [VarAlloc = ",this.rf,"]");return a.join("")};function Zb(){}function ac(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(bc(a.Uf-c));e.push(" ",cc(a.Uf-b));0==a.Me?e.push(" Start        "):1==a.Me?(e.push(" Done "),e.push(bc(a.Nj-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.Qi&&e.push("[VarAlloc ",a.Qi,"] ");return e.join("")}
Zb.prototype.toString=function(){return this.type==p?this.eh:"["+this.type+"] "+this.eh};Yb.prototype.reset=function(){for(var a=0;a<this.Wc.length;a++){var b=this.Le.id;b&&Xb(this.Pe,b);Xb(this.Le,this.Wc[a])}this.Wc.length=0;this.df.clear();this.Dg=wa();this.Nf=this.Fg=this.Gg=this.Hg=this.Ig=0;b=this.jd.Zc();for(a=0;a<b.length;a++){var c=this.jd.get(b[a]);c.count=0;c.time=0;c.rf=0;Xb(this.Eg,c)}this.jd.clear()};
Yb.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Wc.length;d++){var e=this.Wc[d];1==e.Me&&c.pop();a.push(" ",ac(e,this.Dg,b,c.join("")));b=e.Uf;a.push("\n");0==e.Me&&c.push("|  ")}if(0!=this.df.cb()){var f=wa();a.push(" Unstopped timers:\n");Jb(this.df,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",cc(b.startTime),")\n")})}b=this.jd.Zc();for(d=0;d<b.length;d++)c=this.jd.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.Fg,"\n","Total comments created ",
this.Nf,"\n","Overhead start: ",this.Ig," ms\n","Overhead end: ",this.Hg," ms\n","Overhead comment: ",this.Gg," ms\n");return a.join("")};function bc(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function cc(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new Yb;function dc(){}var ec=0;t=dc.prototype;t.key=0;t.wc=r;t.Ce=r;t.ka=function(a,b,c,d,e,f){la(a)?this.hg=n:a&&a.handleEvent&&la(a.handleEvent)?this.hg=r:i(Error("Invalid listener argument"));this.ad=a;this.zg=b;this.src=c;this.type=d;this.capture=!!e;this.Ne=f;this.Ce=r;this.key=++ec;this.wc=r};t.handleEvent=function(a){return this.hg?this.ad.call(this.Ne||this.src,a):this.ad.handleEvent.call(this.ad,a)};!K||kb(9);var fc=!K||kb(9),gc=K&&!ib("8");!Ua||ib("528");Ta&&ib("1.9b")||K&&ib("8")||Sa&&ib("9.5")||Ua&&ib("528");!Ta||ib("8");function hc(a,b){this.type=a;this.currentTarget=this.target=b}H(hc,Rb);t=hc.prototype;t.M=function(){delete this.type;delete this.target;delete this.currentTarget};t.cc=r;t.gd=n;t.stopPropagation=function(){this.cc=n};t.preventDefault=function(){this.gd=r};function ic(a){ic[" "](a);return a}ic[" "]=fa;function jc(a,b){a&&this.ka(a,b)}H(jc,hc);t=jc.prototype;t.target=p;t.relatedTarget=p;t.offsetX=0;t.offsetY=0;t.clientX=0;t.clientY=0;t.screenX=0;t.screenY=0;t.button=0;t.keyCode=0;t.charCode=0;t.ctrlKey=r;t.altKey=r;t.shiftKey=r;t.metaKey=r;t.Ta=p;
t.ka=function(a,b){var c=this.type=a.type;hc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ta){var e;a:{try{ic(d.nodeName);e=n;break a}catch(f){}e=r}e||(d=p)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Ua||a.offsetX!==m?a.offsetX:a.layerX;this.offsetY=Ua||a.offsetY!==m?a.offsetY:a.layerY;this.clientX=a.clientX!==m?a.clientX:a.pageX;this.clientY=a.clientY!==m?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.Ta=a;delete this.gd;delete this.cc};t.stopPropagation=function(){jc.i.stopPropagation.call(this);this.Ta.stopPropagation?this.Ta.stopPropagation():this.Ta.cancelBubble=n};
t.preventDefault=function(){jc.i.preventDefault.call(this);var a=this.Ta;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,gc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};t.th=s("Ta");t.M=function(){jc.i.M.call(this);this.relatedTarget=this.currentTarget=this.target=this.Ta=p};var kc={},lc={},mc={},nc={};
function L(a,b,c,d,e){if(b){if(z(b)){for(var f=0;f<b.length;f++)L(a,b[f],c,d,e);return p}var d=!!d,g=lc;b in g||(g[b]={L:0,Ea:0});g=g[b];d in g||(g[d]={L:0,Ea:0},g.L++);var g=g[d],h=na(a),l;g.Ea++;if(g[h]){l=g[h];for(f=0;f<l.length;f++)if(g=l[f],g.ad==c&&g.Ne==e){if(g.wc)break;return l[f].key}}else l=g[h]=[],g.L++;f=oc();f.src=a;g=new dc;g.ka(c,f,a,b,d,e);c=g.key;f.key=c;l.push(g);kc[c]=g;mc[h]||(mc[h]=[]);mc[h].push(g);a.addEventListener?(a==ea||!a.Rf)&&a.addEventListener(b,f,d):a.attachEvent(b in
nc?nc[b]:nc[b]="on"+b,f);return c}i(Error("Invalid event type"))}function oc(){var a=pc,b=fc?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function qc(a,b,c,d,e){if(z(b))for(var f=0;f<b.length;f++)qc(a,b[f],c,d,e);else a=L(a,b,c,d,e),kc[a].Ce=n}
function rc(a,b,c,d,e){if(z(b))for(var f=0;f<b.length;f++)rc(a,b[f],c,d,e);else{d=!!d;a:{f=lc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=na(a),f[a]))){a=f[a];break a}a=p}if(a)for(f=0;f<a.length;f++)if(a[f].ad==c&&a[f].capture==d&&a[f].Ne==e){sc(a[f].key);break}}}
function sc(a){if(!kc[a])return r;var b=kc[a];if(b.wc)return r;var c=b.src,d=b.type,e=b.zg,f=b.capture;c.removeEventListener?(c==ea||!c.Rf)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in nc?nc[d]:nc[d]="on"+d,e);c=na(c);e=lc[d][f][c];if(mc[c]){var g=mc[c];yb(g,b);0==g.length&&delete mc[c]}b.wc=n;e.og=n;tc(d,f,c,e);delete kc[a];return n}
function tc(a,b,c,d){if(!d.Td&&d.og){for(var e=0,f=0;e<d.length;e++)d[e].wc?d[e].zg.src=p:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.og=r;0==f&&(delete lc[a][b][c],lc[a][b].L--,0==lc[a][b].L&&(delete lc[a][b],lc[a].L--),0==lc[a].L&&delete lc[a])}}function uc(a){var b,c=0,d=b==p;b=!!b;if(a==p)nb(mc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)sc(f.key),c++}});else if(a=na(a),mc[a])for(var a=mc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)sc(f.key),c++}}
function vc(a){var b=yc,a=na(a),c=mc[a];if(c){var d=ia(b),e=ia(m);return d&&e?(c=lc[b],!!c&&!!c[m]&&a in c[m]):!d&&!e?n:wb(c,function(a){return d&&a.type==b||e&&a.capture==m})}return r}function zc(a,b,c,d,e){var f=1,b=na(b);if(a[b]){a.Ea--;a=a[b];a.Td?a.Td++:a.Td=1;try{for(var g=a.length,h=0;h<g;h++){var l=a[h];l&&!l.wc&&(f&=Ac(l,e)!==r)}}finally{a.Td--,tc(c,d,b,a)}}return Boolean(f)}function Ac(a,b){var c=a.handleEvent(b);a.Ce&&sc(a.key);return c}
function pc(a,b){if(!kc[a])return n;var c=kc[a],d=c.type,e=lc;if(!(d in e))return n;var e=e[d],f,g;if(!fc){var h;if(!(h=b))a:{h=["window","event"];for(var l=ea;f=h.shift();)if(y(l[f]))l=l[f];else{h=p;break a}h=l}f=h;h=n in e;l=r in e;if(h){if(0>f.keyCode||f.returnValue!=m)return n;a:{var k=r;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(j){k=n}if(k||f.returnValue==m)f.returnValue=n}}k=new jc;k.ka(f,this);f=n;try{if(h){for(var o=[],v=k.currentTarget;v;v=v.parentNode)o.push(v);g=e[n];g.Ea=g.L;for(var q=
o.length-1;!k.cc&&0<=q&&g.Ea;q--)k.currentTarget=o[q],f&=zc(g,o[q],d,n,k);if(l){g=e[r];g.Ea=g.L;for(q=0;!k.cc&&q<o.length&&g.Ea;q++)k.currentTarget=o[q],f&=zc(g,o[q],d,r,k)}}else f=Ac(c,k)}finally{o&&(o.length=0),k.La()}return f}d=new jc(b,this);try{f=Ac(c,d)}finally{d.La()}return f}var Bc=0;function Cc(a){return a+"_"+Bc++};function Dc(){}H(Dc,Rb);t=Dc.prototype;t.Rf=n;t.Vd=p;t.gf=da("Vd");t.addEventListener=function(a,b,c,d){L(this,a,b,c,d)};t.removeEventListener=function(a,b,c,d){rc(this,a,b,c,d)};
t.dispatchEvent=function(a){var b=a.type||a,c=lc;if(b in c){if(ka(a))a=new hc(a,this);else if(a instanceof hc)a.target=a.target||this;else{var d=a,a=new hc(b,this);rb(a,d)}var d=1,e,c=c[b],b=n in c,f;if(b){e=[];for(f=this;f;f=f.Vd)e.push(f);f=c[n];f.Ea=f.L;for(var g=e.length-1;!a.cc&&0<=g&&f.Ea;g--)a.currentTarget=e[g],d&=zc(f,e[g],a.type,n,a)&&a.gd!=r}if(r in c)if(f=c[r],f.Ea=f.L,b)for(g=0;!a.cc&&g<e.length&&f.Ea;g++)a.currentTarget=e[g],d&=zc(f,e[g],a.type,r,a)&&a.gd!=r;else for(e=this;!a.cc&&e&&
f.Ea;e=e.Vd)a.currentTarget=e,d&=zc(f,e,a.type,r,a)&&a.gd!=r;a=Boolean(d)}else a=n;return a};t.M=function(){Dc.i.M.call(this);uc(this);this.Vd=p};function M(){this.c="base";this.pa=window["X.counter"].Ui();this.e=r}H(M,Dc);M.prototype.__defineGetter__("classname",s("c"));M.prototype.__defineGetter__("id",s("pa"));E("X.base",M);function Ec(a,b){this.wa=new xa(a);this.$=new xa(b)}Ec.prototype={f:function(){return new Ec(this.wa.f(),this.$.f())},$b:function(){this.$=this.$.Ye()},Hh:function(a,b){return new Ec(this.wa.ig(a.wa,b),this.$.ig(a.$,b))}};function Fc(a,b){this.$=a;this.md=b}Fc.prototype={f:function(){return new Fc(this.$.f(),this.md)},$b:function(){this.$=this.$.Ye();this.md=-this.md}};function Gc(a,b){this.hb=a;this.ae=b;var c=a[0].wa,d=a[2].wa,d=a[1].wa.cd(c).He(d.cd(c)).kd();this.va=new Fc(d,d.rc(c))}
Gc.prototype={f:function(){var a=this.hb.map(function(a){return a.f()});return new Gc(a,this.ae)},$b:function(){this.hb.reverse().map(function(a){a.$b()});this.va.$b()},Cg:function(a,b,c,d,e){for(var f=0,g=[],h=0;h<this.hb.length;h++){var l=a.$.rc(this.hb[h].wa)-a.md,l=-1.0E-5>l?2:1.0E-5<l?1:0,f=f|l;g.push(l)}switch(f){case 0:(0<a.$.rc(this.va.$)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(h=0;h<this.hb.length;h++){var k=(h+1)%this.hb.length,l=g[h],
j=g[k],f=this.hb[h],k=this.hb[k];2!=l&&b.push(f);1!=l&&c.push(2!=l?f.f():f);3==(l|j)&&(l=(a.md-a.$.rc(f.wa))/a.$.rc(k.wa.cd(f.wa)),l=f.Hh(k,l),b.push(l),c.push(l.f()))}3<=b.length&&d.push(new Gc(b,this.ae));3<=c.length&&e.push(new Gc(c,this.ae))}}};function Hc(a){this.fa=this.ga=this.va=p;this.A=[];a&&this.nc(a)}
Hc.prototype={f:function(){var a=new Hc;a.Bi(this.va&&this.va.f());a.Ai(this.ga&&this.ga.f());a.zi(this.fa&&this.fa.f());a.Zd(this.A.map(function(a){return a.f()}));return a},W:function(){for(var a=0;a<this.A.length;a++)this.A[a].$b();this.va.$b();this.ga&&this.ga.W();this.fa&&this.fa.W();a=this.ga;this.ga=this.fa;this.fa=a},Ee:function(a){if(!this.va)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].Cg(this.va,b,c,b,c);this.ga&&(b=this.ga.Ee(b));c=this.fa?this.fa.Ee(c):[];return b.concat(c)},
Ka:function(a){this.A=a.Ee(this.A);this.ga&&this.ga.Ka(a);this.fa&&this.fa.Ka(a)},Bb:function(){var a=this.A.slice();this.ga&&(a=a.concat(this.ga.Bb()));this.fa&&(a=a.concat(this.fa.Bb()));return a},nc:function(a){if(a.length){this.va||(this.va=a[0].va.f());for(var b=[],c=[],d=0;d<a.length;d++)a[d].Cg(this.va,this.A,this.A,b,c);b.length&&(this.ga||(this.ga=new Hc),this.ga.nc(b));c.length&&(this.fa||(this.fa=new Hc),this.fa.nc(c))}},Bi:da("va"),Ai:da("ga"),zi:da("fa"),Zd:da("A")};function Ic(){this.A=[]}function Jc(a){var b=new Ic;b.Zd(a);return b}
Ic.prototype={f:function(){var a=new Ic;a.Zd(this.A.map(function(a){return a.f()}));return a},of:function(a){var b=new Hc(this.f().A),a=new Hc(a.f().A);b.Ka(a);a.Ka(b);a.W();a.Ka(b);a.W();b.nc(a.Bb());return Jc(b.Bb())},gb:function(a){var b=new Hc(this.f().A),a=new Hc(a.f().A);b.W();b.Ka(a);a.Ka(b);a.W();a.Ka(b);a.W();b.nc(a.Bb());b.W();return Jc(b.Bb())},Re:function(a){var b=new Hc(this.f().A),a=new Hc(a.f().A);b.W();a.Ka(b);a.W();b.Ka(a);a.Ka(b);b.nc(a.Bb());b.W();return Jc(b.Bb())},inverse:function(){var a=
this.f();a.A.map(function(a){a.$b()});return a},Zd:da("A")};function Kc(){M.call(this);this.c="indexer";this.ye=[];this.qb={}}H(Kc,M);Kc.prototype.add=function(a){y(a)||i(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.qb||(this.qb[b]=this.ye.length,this.ye.push(a));return this.qb[b]};Kc.prototype.unique=s("ye");function Lc(a){M.call(this);this.c="file";this.wd=a;this.e=n}H(Lc,M);function Mc(){this.Hb=this.p=p;this.Af=r}Mc.prototype.__defineSetter__("file",function(a){this.p=!y(a)||z(a)&&0==a.length?p:z(a)?1==a.length?new Lc(a[0]):vb(a,function(a){var c=new N;c.p=new Lc(a);return c}):new Lc(a)});Mc.prototype.__defineGetter__("file",function(){return!this.p?"":z(this.p)?this.p.map(function(a){return a.p.wd}):this.p.wd});Mc.prototype.__defineGetter__("filedata",s("Hb"));
Mc.prototype.__defineSetter__("filedata",function(a){if(!y(a)||z(a)&&0==a.length)this.Hb=p;if(z(a))if(1==a.length)this.Hb=a[0];else{var b=this.p.length,c;for(c=0;c<b;c++)this.p[c].Hb=a[c]}else this.Hb=a});function Nc(){M.call(this);this.c="colortable";this.qb=new Kb;ya(this,new Mc)}H(Nc,M);Nc.prototype.add=function(a,b,c,d,e,f){(!D(a)||!D(c)||!D(d)||!D(e)||!D(f))&&i(Error("Invalid color table entry."));this.qb.set(a,[b,c,d,e,f]);this.e=n};function Oc(a,b,c){this.x=ia(a)?a:0;this.y=ia(b)?b:0;this.b=ia(c)?c:0}Oc.prototype.f=function(){return new Oc(this.x,this.y,this.b)};Oc.prototype.nf=function(){return[this.x,this.y,this.b]};function O(a,b,c){this.x=a;this.y=b;this.b=c}H(O,Oc);t=O.prototype;t.f=function(){return new O(this.x,this.y,this.b)};t.bc=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};t.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};t.W=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};t.normalize=function(){return this.scale(1/this.bc())};t.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
t.gb=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};t.Vc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Pc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Qc(a,b){return new O(a.x+b.x,a.y+b.y,a.b+b.b)}function Rc(a,b){return new O(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Sc(a,b){this.x=ia(a)?a:0;this.y=ia(b)?b:0}Sc.prototype.f=function(){return new Sc(this.x,this.y)};function Tc(a,b){return new Sc(a.x-b.x,a.y-b.y)};function Uc(a,b){this.x=a;this.y=b}H(Uc,Sc);t=Uc.prototype;t.f=function(){return new Uc(this.x,this.y)};t.bc=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};t.scale=function(a){this.x*=a;this.y*=a;return this};t.W=function(){this.x=-this.x;this.y=-this.y;return this};t.normalize=function(){return this.scale(1/this.bc())};t.add=function(a){this.x+=a.x;this.y+=a.y;return this};t.gb=function(a){this.x-=a.x;this.y-=a.y;return this};
t.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};t.Vc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function Vc(a,b){this.width=a;this.height=b}function Wc(a,b){return a==b?n:!a||!b?r:a.width==b.width&&a.height==b.height}Vc.prototype.f=function(){return new Vc(this.width,this.height)};Vc.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};Vc.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};Vc.prototype.scale=function(a){this.width*=a;this.height*=a;return this};function Xc(a,b){if(a instanceof Xc)this.Q=a.nf();else{var c;if(c=ja(a))a:{for(var d=c=0;d<a.length;d++){if(!ja(a[d])||0<c&&a[d].length!=c){c=r;break a}for(var e=0;e<a[d].length;e++)if(!D(a[d][e])){c=r;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.Q=Ab(a):a instanceof Vc?this.Q=Yc(a.height,a.width):D(a)&&D(b)&&0<a&&0<b?this.Q=Yc(a,b):i(Error("Invalid argument(s) for Matrix contructor"))}this.F=new Vc(this.Q[0].length,this.Q.length)}
function Zc(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new Xc(b)}function $c(a,b,c){for(var d=0;d<a.ua().height;d++)for(var e=0;e<a.ua().width;e++)b.call(c,a.Q[d][e],d,e,a)}function ad(a,b){var c=new Xc(a.ua());$c(a,function(d,e,f){c.Q[e][f]=b.call(m,d,e,f,a)});return c}function Yc(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}t=Xc.prototype;
t.add=function(a){Wc(this.F,a.ua())||i(Error("Matrix summation is only supported on arrays of equal size"));return ad(this,function(b,c,d){return b+a.Q[c][d]})};t.Vc=function(a,b){if(this.F.width!=a.F.width||this.F.height!=a.F.height)return r;for(var c=b||0,d=0;d<this.F.height;d++)for(var e=0;e<this.F.width;e++)if(!(Math.abs(this.Q[d][e]-a.Q[d][e])<=(c||1.0E-6)))return r;return n};t.ua=s("F");t.R=function(a,b){return!(0<=a&&a<this.F.height&&0<=b&&b<this.F.width)?p:this.Q[a][b]};
t.k=function(a,b,c){0<=a&&a<this.F.height&&0<=b&&b<this.F.width||i(Error("Index out of bounds when setting matrix value, ("+a+","+b+") in size ("+this.F.height+","+this.F.width+")"));this.Q[a][b]=c};t.multiply=function(a){if(a instanceof Xc)return this.F.width!=a.ua().height&&i(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),bd(this,a);if(D(a))return cd(this,a);i(Error("A matrix can only be multiplied by a number or another matrix."))};
t.gb=function(a){Wc(this.F,a.ua())||i(Error("Matrix subtraction is only supported on arrays of equal size."));return ad(this,function(b,c,d){return b-a.Q[c][d]})};t.nf=s("Q");function bd(a,b){var c=new Xc(a.F.height,b.ua().width);$c(c,function(a,e,f){for(var g=a=0;g<this.F.width;g++)a+=this.R(e,g)*b.R(g,f);c.k(e,f,a)},a);return c}function cd(a,b){return ad(a,function(a){return a*b})};function R(a,b){Xc.call(this,a,b);this.c="matrix"}H(R,Xc);function ed(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new R(b)}t=R.prototype;t.Da=function(){var a=[],b=this.ua(),c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.R(c,d));return a};
t.translate=function(a){this.F.width!=this.F.height&&i(Error("Can not translate non-square matrix."));var b=this.ua(),c=Zc(b.height);a instanceof Uc&&3==b.height?(c.k(0,2,a.x),c.k(1,2,a.y)):a instanceof O&&4==b.height?(c.k(0,3,a.x),c.k(1,3,a.y),c.k(2,3,a.b)):i(Error("Translation failed."));return new R(this.multiply(c))};
t.rotate=function(a,b){(4!=this.ua().height||this.F.width!=this.F.height)&&i(Error("Only 4x4 matrices can be rotated."));(!y(b)||!(b instanceof O))&&i(Error("Invalid axis vector."));D(a)||i(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=Zc(4);f.k(0,0,d+c.x*c.x*(1-d));f.k(0,1,c.x*c.y*(1-d)-c.b*e);f.k(0,2,c.x*c.b*(1-d)+c.y*e);f.k(1,0,c.y*c.x*(1-d)+c.b*e);f.k(1,1,d+c.y*c.y*(1-d));f.k(1,2,c.y*c.b*(1-d)-c.x*e);f.k(2,0,c.b*c.x*(1-d)-c.y*e);f.k(2,1,c.b*c.y*(1-d)+c.x*e);f.k(2,
2,d+c.b*c.b*(1-d));return new R(this.multiply(f))};t.Oa=function(a){var b=this.ua(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof O&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):i(Error("Multiplication by vector failed."));a=this.multiply(new Xc(c));return new O(parseFloat(a.R(0,0)),parseFloat(a.R(1,0)),parseFloat(a.R(2,0)))};t.Oi=function(a,b){var c=this.Q[a];this.Q[a]=this.Q[b];this.Q[b]=c};
t.Ni=function(a,b){for(var c=this.ua(),d=0,d=0;d<c.height;d++){var e=this.R(d,a);e||(e=0);var f=this.R(d,b);f||(f=0);this.k(d,a,f);this.k(d,b,e)}};E("X.matrix",R);E("X.matrix.createIdentityMatrix",ed);E("X.matrix.prototype.flatten",R.prototype.Da);E("X.matrix.prototype.translate",R.prototype.translate);E("X.matrix.prototype.rotate",R.prototype.rotate);E("X.matrix.prototype.toArray",R.prototype.nf);E("X.matrix.prototype.getValueAt",R.prototype.R);E("X.matrix.prototype.setValueAt",R.prototype.k);
E("X.matrix.prototype.multiplyByVector",R.prototype.Oa);E("X.matrix.prototype.swapRows",R.prototype.Oi);E("X.matrix.prototype.swapCols",R.prototype.Ni);function gd(){M.call(this);this.c="transform";this.C=ed(4);this.xf=new Float32Array(this.C.Da())}H(gd,M);gd.prototype.__defineGetter__("matrix",s("C"));gd.prototype.__defineSetter__("matrix",function(a){(!y(a)||!(a instanceof R))&&i(Error("Invalid matrix."));this.C=a;this.o()});t=gd.prototype;t.ti=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new O(0,1,0));this.o()};
t.ui=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new O(1,0,0));this.o()};t.vi=function(a){(!D(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.C=this.C.rotate(a*Math.PI/180,new O(0,0,1));this.o()};t.Ri=function(a){D(a)||i(Error("Invalid distance."));this.C=this.C.translate(new O(a,0,0));this.o()};t.Si=function(a){D(a)||i(Error("Invalid distance."));this.C=this.C.translate(new O(0,a,0));this.o()};
t.Ti=function(a){D(a)||i(Error("Invalid distance."));this.C=this.C.translate(new O(0,0,a));this.o()};function hd(a,b,c){var d=a.C.R(b,c);d||(d=0);a.C.k(b,c,-1*d);a.o()}t.ph=function(){hd(this,0,0)};t.qh=function(){hd(this,1,1)};t.rh=function(){hd(this,2,2)};t.o=function(){this.xf=new Float32Array(this.C.Da());this.e=n};E("X.transform",gd);E("X.transform.prototype.rotateX",gd.prototype.ti);E("X.transform.prototype.rotateY",gd.prototype.ui);E("X.transform.prototype.rotateZ",gd.prototype.vi);
E("X.transform.prototype.translateX",gd.prototype.Ri);E("X.transform.prototype.translateY",gd.prototype.Si);E("X.transform.prototype.translateZ",gd.prototype.Ti);E("X.transform.prototype.flipX",gd.prototype.ph);E("X.transform.prototype.flipY",gd.prototype.qh);E("X.transform.prototype.flipZ",gd.prototype.rh);E("X.transform.prototype.modified",gd.prototype.o);function id(){M.call(this);this.c="texture";this.sa=this.lb=this.p=p;this.xb=this.yb=0;ya(this,new Mc)}H(id,M);E("X.texture",id);function S(a,b){M.call(this);this.c="triplets";this.Pb=Infinity;this.Mb=-Infinity;this.Qb=Infinity;this.Nb=-Infinity;this.Rb=Infinity;this.Ob=-Infinity;this.nd=[0,0,0];this.w=0;this.I=new Float32Array(a);y(b)&&(this.I=b.I.subarray(0,b.I.length),this.w=this.I.length,this.Pb=b.Pb,this.Mb=b.Mb,this.Qb=b.Qb,this.Nb=b.Nb,this.Rb=b.Rb,this.Ob=b.Ob,this.nd=b.nd.slice())}H(S,M);t=S.prototype;
t.add=function(a,b,c){this.Pb=Math.min(this.Pb,a);this.Mb=Math.max(this.Mb,a);this.Qb=Math.min(this.Qb,b);this.Nb=Math.max(this.Nb,b);this.Rb=Math.min(this.Rb,c);this.Ob=Math.max(this.Ob,c);this.nd=[(this.Pb+this.Mb)/2,(this.Qb+this.Nb)/2,(this.Rb+this.Ob)/2];this.e=n;this.I[this.w++]=a;this.I[this.w++]=b;this.I[this.w++]=c;return this.w/3};t.yc=function(){if(this.w!=this.I.length){var a=new Float32Array(this.w);a.set(this.I.subarray(0,this.w));this.I=a}};
t.get=function(a){a*=3;return[this.I[a],this.I[a+1],this.I[a+2]]};t.remove=function(){i(Error("Not implemented."))};t.clear=function(){this.I=new Float32Array(this.I.length);this.e=n};S.prototype.__defineGetter__("count",function(){this.yc();return this.I.length/3});S.prototype.__defineGetter__("length",function(){this.yc();return this.I.length});E("X.triplets",S);E("X.triplets.prototype.add",S.prototype.add);E("X.triplets.prototype.resize",S.prototype.yc);E("X.triplets.prototype.get",S.prototype.get);
E("X.triplets.prototype.remove",S.prototype.remove);E("X.triplets.prototype.clear",S.prototype.clear);function U(){this.ja=jd;this.Xb=new gd;this.Fb=[1,1,1];this.Wb=this.z=this.S=this.h=this.g=p;this.Mc=[];this.ma=n;this.mc=this.Nc=1;this.gc=p;this.Fc=r;this.V=1;this.U=0}var jd="TRIANGLES";U.prototype.__defineSetter__("type",function(a){return this.ja=a});U.prototype.__defineGetter__("type",s("ja"));U.prototype.__defineGetter__("texture",function(){this.z||(this.z=new id);return this.z});U.prototype.__defineGetter__("transform",s("Xb"));U.prototype.__defineGetter__("points",s("g"));
U.prototype.__defineSetter__("points",da("g"));U.prototype.__defineGetter__("normals",s("h"));U.prototype.__defineSetter__("normals",da("h"));U.prototype.__defineGetter__("colors",s("S"));U.prototype.__defineSetter__("colors",da("S"));U.prototype.__defineGetter__("color",s("Fb"));U.prototype.__defineSetter__("color",function(a){(!y(a)||!z(a)||3!=a.length)&&i(Error("Invalid color."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.Fb=a;this.e=n});
U.prototype.__defineGetter__("opacity",s("V"));U.prototype.__defineSetter__("opacity",function(a){(!D(a)||1<a||0>a)&&i(Error("Invalid opacity."));for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.V=a;this.e=n});U.prototype.__defineGetter__("caption",s("gc"));U.prototype.__defineSetter__("caption",function(a){this.gc=a;this.e=n});U.prototype.__defineGetter__("visible",s("ma"));
U.prototype.__defineSetter__("visible",function(a){for(var b=this.d,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.ma=a;this.e=n});U.prototype.__defineGetter__("pointsize",s("Nc"));U.prototype.__defineSetter__("pointsize",function(a){D(a)||i(Error("Invalid point size."));this.Nc=a;this.e=n});U.prototype.__defineGetter__("magicmode",s("Fc"));U.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&i(Error("Invalid magic mode setting."));this.Fc=a;this.e=n});
U.prototype.__defineGetter__("linewidth",s("mc"));U.prototype.__defineSetter__("linewidth",function(a){D(a)||i(Error("Invalid line width."));this.mc=a;this.e=n});function kd(){this.Ha=Infinity;this.ba=this.Ba=-Infinity;this.ca=Infinity;this.tb=[0,0,0];this.rb=[1,1,1]}kd.prototype.__defineGetter__("lowerThreshold",s("ba"));kd.prototype.__defineSetter__("lowerThreshold",da("ba"));kd.prototype.__defineGetter__("upperThreshold",s("ca"));kd.prototype.__defineSetter__("upperThreshold",da("ca"));kd.prototype.__defineGetter__("min",s("Ha"));kd.prototype.__defineGetter__("max",s("Ba"));kd.prototype.__defineGetter__("minColor",s("tb"));
kd.prototype.__defineSetter__("minColor",function(a){(!y(a)||!z(a)||3!=a.length)&&i(Error("Invalid min. color."));this.tb=a});kd.prototype.__defineGetter__("maxColor",s("rb"));kd.prototype.__defineSetter__("maxColor",function(a){(!y(a)||!z(a)||3!=a.length)&&i(Error("Invalid max. color."));this.rb=a});function ld(){M.call(this);this.c="scalars";this.Bc=this.u=p;this.Jf=n;ya(this,new Mc);ya(this,new kd);this.tb=[0,1,0];this.rb=[1,0,0]}H(ld,M);ld.prototype.__defineGetter__("array",s("u"));ld.prototype.__defineSetter__("array",function(a){this.Bc=this.u=a;this.e=n});E("X.scalars",ld);function V(a){M.call(this);this.c="object";this.d=[];this.t=this.X=p;ya(this,new U);y(a)&&this.Yb(a)}H(V,M);
V.prototype.Yb=function(a){this.ja=a.ja;this.Xb=new gd;this.Xb.C=new R(a.Xb.C.Q);this.Fb=a.Fb.slice();a.g&&(this.g=new S(a.g.length,a.g));a.h&&(this.h=new S(a.h.length,a.h));a.S&&(this.S=new S(a.S.length,a.S));this.z=a.z;this.Wb=a.Wb;a.p&&(this.p=new Lc((new String(a.p.wd)).toString()));this.V=a.V;this.d.length=0;var b=a.d;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.d.push(new I[b[d].c](b[d]));this.ma=a.ma;this.Nc=a.Nc;this.mc=a.mc;a.gc&&(this.gc=(new String(a.gc)).toString());this.Fc=a.Fc;this.Mc=
a.Mc.slice();this.e=n};V.prototype.__defineGetter__("colortable",function(){this.X||(this.X=new Nc);return this.X});V.prototype.__defineGetter__("scalars",function(){this.t||(this.t=new ld);return this.t});V.prototype.__defineGetter__("children",s("d"));V.prototype.o=function(){var a=new md;a.Z=this;this.dispatchEvent(a)};
function nd(a,b){(!y(a)||!y(b)||!(a instanceof V)||!(b instanceof V))&&i(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.V?-1:1==b.V?1:y(a.U)&&y(b.U)&&a.U>b.U?-1:1}E("X.object",V);E("X.object.prototype.modified",V.prototype.o);function od(){}function pd(a){for(var b=a.g.count,c=[],d=0,d=0;d<b;d+=3){var e=a.g.get(d),f=a.g.get(d+1),g=a.g.get(d+2),h=a.h.get(d),l=a.h.get(d+1),k=a.h.get(d+2),j=a.Fb;a.S&&0<a.S.length&&(j=a.S.get(d));var o=[];o.push(new Ec(e,h));o.push(new Ec(f,l));o.push(new Ec(g,k));c.push(new Gc(o,j))}return Jc(c)}
function qd(a,b){(!y(b)||!(b instanceof Ic))&&i(Error("Invalid CSG object."));var c=new Kc,d=[];vb(b.A,function(a){for(var b=[],g=a.ae,b=vb(a.hb,function(a){a.color=g;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.Tg=vb(c.unique(),function(a){return[a.wa.x(),a.wa.y(),a.wa.b()]});a.Sg=vb(c.unique(),function(a){return[a.$.x(),a.$.y(),a.$.b()]});a.Rg=vb(c.unique(),function(a){return!a.color?p:[a.color[0],a.color[1],a.color[2]]});a.g=new S(9*d.length);a.h=new S(9*d.length);
a.S=new S(9*d.length);vb(d,function(a){var b=a[0],c=a[1],a=a[2],d=this.Tg,l=this.Sg,k=this.Rg;this.g.add(d[b][0],d[b][1],d[b][2]);this.g.add(d[c][0],d[c][1],d[c][2]);this.g.add(d[a][0],d[a][1],d[a][2]);this.h.add(l[b][0],l[b][1],l[b][2]);this.h.add(l[c][0],l[c][1],l[c][2]);this.h.add(l[a][0],l[a][1],l[a][2]);k[b]&&this.S.add(k[b][0],k[b][1],k[b][2]);k[c]&&this.S.add(k[c][0],k[c][1],k[c][2]);k[a]&&this.S.add(k[a][0],k[a][1],k[a][2])}.bind(a));0==a.S.w&&(a.S=p);a.ja=jd}
od.prototype.of=function(a){(!y(a)||!(a instanceof Ic)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=pd(b));a=new V;ya(a,new od);qd(a,pd(this).of(b));return a};od.prototype.gb=function(a){(!y(a)||!(a instanceof Ic)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=pd(b));a=new V;ya(a,new od);qd(a,pd(this).gb(b));return a};
od.prototype.Re=function(a){(!y(a)||!(a instanceof Ic)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=pd(b));a=new V;ya(a,new od);qd(a,pd(this).Re(b));return a};od.prototype.inverse=function(){var a=new V;ya(a,new od);qd(a,pd(this).inverse());return a};E("X.constructable",od);E("X.constructable.prototype.intersect",od.prototype.Re);E("X.constructable.prototype.inverse",od.prototype.inverse);E("X.constructable.prototype.subtract",od.prototype.gb);
E("X.constructable.prototype.union",od.prototype.of);function rd(a){hc.call(this,a);this.c="event"}H(rd,hc);var sd=Cc("pan"),td=Cc("rotate"),ud=Cc("zoom"),vd=Cc("scroll");Cc("render");var wd=Cc("resetview"),xd=Cc("windowlevel"),yc=Cc("modified"),yd=Cc("progress"),zd=Cc("hover"),Ad=Cc("hover_end");function Bd(){rd.call(this,xd);this.le=this.ze=0}H(Bd,rd);function Cd(){rd.call(this,sd);this.U=new Uc(0,0)}H(Cd,rd);function Dd(){rd.call(this,td);this.U=new Uc(0,0)}H(Dd,rd);function Ed(){rd.call(this,ud);this.jb=this.Kb=r}H(Ed,rd);
function Fd(){rd.call(this,vd);this.J=r}H(Fd,rd);function Hd(){rd.call(this,zd);this.Dd=this.Cd=0}H(Hd,rd);function Id(){rd.call(this,Ad)}H(Id,rd);function Jd(){rd.call(this,wd)}H(Jd,rd);function md(){rd.call(this,yc);this.s=this.Z=p}H(md,rd);function Kd(){rd.call(this,yd);this.Kf=0}H(Kd,rd);function W(){M.call(this);this.c="parser";this.aa=p;this.w=0;this.Wg=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.sd=n}H(W,M);W.prototype.parse=function(){i(Error("The function parse() should be overloaded."))};function Ld(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function Y(a,b,c){y(c)||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array,d=4}b=new e(a.aa.slice(a.w,a.w+=c*d));if(a.Wg!=a.sd){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Md(a,b,c){I.Ga(a.c+".reslice");var d=b.Y,e=c.max,f=c.data,g=d[2],h=d[1],d=d[0],l=b.n!=p,k=h*d,j=Array(g),o=Array(g),v=0,q=p;b.X&&(q=b.X.qb);for(var w=0,u=0,B=0,A=0,x=4*k,w=0;w<g;w++){j[w]=Array(h);o[w]=Array(h);for(var C=f.subarray(w*k,(w+1)*k),F=new Uint8Array(x),u=A=0;u<h;u++){j[w][u]=new c.data.constructor(d);o[w][u]=new c.data.constructor(d);for(B=0;B<d;B++){var v=C[A],G=0,P=0,Q=0,J=0;q?(J=q.get(Math.floor(v)),J||(G=q.Ma(),J=G[G.length-1]),G=255*J[1],P=255*J[2],Q=255*J[3],J=255*J[4]):
(G=P=Q=255*(v/e),J=255);var T=4*A;F[T]=G;F[++T]=P;F[++T]=Q;F[++T]=J;j[w][u][B]=255*(v/e);o[w][u][B]=v;A++}}v=new id;v.sa=F;v.yb=d;v.xb=h;C=b.$a.d[w];C.z=v;l&&(C.n=b.n.$a.d[w].z)}d!=h?l?b.X?(Nd(g,d,h,o,b.X,b.P,b.n.P,n),Nd(g,h,d,o,b.X,b.O,b.n.O,r)):(Od(g,d,h,j,b.P,b.n.P,n),Od(g,h,d,j,b.O,b.n.O,r)):b.X?(Nd(g,d,h,o,b.X,b.P,p,n),Nd(g,h,d,o,b.X,b.O,p,r)):(Od(g,d,h,j,b.P,p,n),Od(g,h,d,j,b.O,p,r)):l?b.X?Pd(g,d,h,j,b.X,b.O,b.n.O,b.P,b.n.P):Qd(g,d,h,j,b.O,b.n.O,b.P,b.n.P):b.X?Pd(g,d,h,o,b.X,b.O,p,b.P,p):Qd(g,
d,h,j,b.O,p,b.P,p);I.Aa(a.c+".reslice");return o}function Od(a,b,c,d,e,f,g){for(var h=4*a*b,l=0,l=0;l<c;l++){for(var k=new Uint8Array(h),j=0,o=0,j=0;j<a;j++)for(var v=0,q=d[j],v=0;v<b;v++){var w,u=w=g?q[l][v]:q[v][l],B=w,A=4*o;k[A]=w;k[++A]=u;k[++A]=B;k[++A]=255;o++}j=new id;j.sa=k;j.yb=b;j.xb=a;k=e.d[l];k.z=j;f&&(k.n=f.d[l].z)}}
function Nd(a,b,c,d,e,f,g,h){for(var e=e.qb,l=4*a*b,k=0,k=0;k<c;k++){for(var j=new Uint8Array(l),o=0,v=0,o=0;o<a;o++)for(var q=d[o],w=0,w=0;w<b;w++){var u=e.get(Math.floor(h?q[k][w]:q[w][k]));u||(u=e.Ma(),u=u[u.length-1]);var B=255*u[2],A=255*u[3],x=255*u[4],C=4*v;j[C]=255*u[1];j[++C]=B;j[++C]=A;j[++C]=x;v++}o=new id;o.sa=j;o.yb=b;o.xb=a;j=f.d[k];j.z=o;g&&(j.n=g.d[k].z)}}
function Qd(a,b,c,d,e,f,g,h){for(var l=4*a*b,k=0,k=0;k<c;k++){for(var j=new Uint8Array(l),o=new Uint8Array(l),v=0,q=0,q=0;q<a;q++)for(var w=d[q],u=0,u=0;u<b;u++){var B=w[u][k],A=B,x=B,C=4*v;j[C]=B;j[++C]=A;j[++C]=x;j[++C]=255;x=A=B=C=w[k][u];C=4*v;o[C]=B;o[++C]=A;o[++C]=x;o[++C]=255;v++}v=new id;v.sa=j;v.yb=b;v.xb=a;j=e.d[k];j.z=v;f&&(j.n=f.d[k].z);j=new id;j.sa=o;j.yb=b;j.xb=a;o=g.d[k];o.z=j;h&&(o.n=h.d[k].z)}}
function Pd(a,b,c,d,e,f,g,h,l){for(var e=e.qb,k=4*a*b,j=0,j=0;j<c;j++){for(var o=new Uint8Array(k),v=new Uint8Array(k),q=0,w=0,w=0;w<a;w++)for(var u=d[w],B=0,B=0;B<b;B++){var A=e.get(Math.floor(u[B][j]));if(!A)var x=e.Ma(),A=x[x.length-1];var C=255*A[2],F=255*A[3],G=255*A[4],x=4*q;o[x]=255*A[1];o[++x]=C;o[++x]=F;o[++x]=G;x=e.get(Math.floor(u[j][B]));x||(x=e.Ma(),x=x[x.length-1]);A=255*x[1];C=255*x[2];F=255*x[3];G=255*x[4];x=4*q;v[x]=A;v[++x]=C;v[++x]=F;v[++x]=G;q++}q=new id;q.sa=o;q.yb=b;q.xb=a;o=
f.d[j];o.z=q;g&&(o.n=g.d[j].z);o=new id;o.sa=v;o.yb=b;o.xb=a;v=h.d[j];v.z=o;l&&(v.n=l.d[j].z)}};function Sd(){W.call(this);this.c="parserLBL"}H(Sd,W);
Sd.prototype.parse=function(a,b,c){I.Ga(this.c+".parse");var d=b.Mc,e=d.length;0==e&&i(Error("No _pointIndices defined on the X.object."));this.aa=c;for(var f=[],g=Y(this,"uchar",c.byteLength),h=g.length,l=r,k=0,c=1;c<h;c++)10==g[c-1]?(k=c,l=n):l&&32==g[c]&&(l=parseInt(String.fromCharCode.apply(p,g.subarray(k,c)),10),f.push(l),l=r);g=b.t.u?b.t.u:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)k=d[c],k>e&&i(Error("Could not find scalar for vertex.")),
k=g[k],f[h++]=k,f[h++]=k,f[h++]=k;b.t.u=g;b.t.Bc=f;b.t.e=n;I.Aa(this.c+".parse");d=new md;d.Z=b;d.s=a;this.dispatchEvent(d)};E("X.parserLBL",Sd);E("X.parserLBL.prototype.parse",Sd.prototype.parse);function Td(a){this.q=a;this.jg=L(this.q,Ta?"DOMMouseScroll":"mousewheel",this)}H(Td,Dc);
Td.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.Ta;if("mousewheel"==a.type){c=1;if(K||Ua&&(Na||ib("532.0")))c=40;d=Ua&&Ma&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ia(a.wheelDeltaX)?(b=Ua&&Ma&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Ua&&Ma&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ia(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;D(this.lg)&&Math.min(Math.max(b,-this.lg),this.lg);D(this.mg)&&(c=Math.min(Math.max(c,
-this.mg),this.mg));b=new Ud(d,a,0,c);try{this.dispatchEvent(b)}finally{b.La()}};Td.prototype.M=function(){Td.i.M.call(this);sc(this.jg);delete this.jg};function Ud(a,b,c,d){b&&this.ka(b,m);this.type="mousewheel";this.detail=a;this.qc=d}H(Ud,jc);K||Ua&&ib("525");var Vd;function Wd(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Bb(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=tb(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var Xd=!K||kb(9);!Ta&&!K||K&&kb(9)||Ta&&ib("1.9.1");K&&ib("9");function Yd(a){return a?new Zd($d(a)):Vd||(Vd=new Zd)}function ae(a){return ka(a)?document.getElementById(a):a}function be(a,b){nb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in ce?a.setAttribute(ce[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var ce={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function de(a,b,c){return ee(document,arguments)}
function ee(a,b){var c=b[0],d=b[1];if(!Xd&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',za(d.name),'"');if(d.type){c.push(' type="',za(d.type),'"');var e={};rb(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(ka(d)?c.className=d:z(d)?Wd.apply(p,[c].concat(d)):be(c,d));2<b.length&&fe(a,c,b);return c}
function fe(a,b,c){function d(c){c&&b.appendChild(ka(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];ja(f)&&!(ma(f)&&0<f.nodeType)?ub(ge(f)?Ab(f):f,d):d(f)}}function he(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function ie(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function je(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function $d(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function ge(a){if(a&&"number"==typeof a.length){if(ma(a))return"function"==typeof a.item||"string"==typeof a.item;if(la(a))return"function"==typeof a.item}return r}function Zd(a){this.N=a||ea.document||document}t=Zd.prototype;
t.Ld=Yd;t.j=function(a){return ka(a)?this.N.getElementById(a):a};t.oc=function(a,b,c){return ee(this.N,arguments)};t.createElement=function(a){return this.N.createElement(a)};t.createTextNode=function(a){return this.N.createTextNode(a)};function ke(a){return"CSS1Compat"==a.N.compatMode}function le(a){var b=a.N,a=!Ua&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new Sc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}t.appendChild=function(a,b){a.appendChild(b)};
t.contains=je;function Z(a){(!y(a)||!(a instanceof Element))&&i(Error("Could not add interactor to the given element."));M.call(this);this.c="interactor";this.ic=a;this.ne=this.Df=this.Cf=this.Ef=this.Bf=this.Ff=p;this.me=n;this.zb=this.sb=this.Ya=r;this.vd=[0,0];this.he=new Uc(0,0);this.T={MOUSEWHEEL_ENABLED:n,MOUSECLICKS_ENABLED:n,KEYBOARD_ENABLED:n,HOVERING_ENABLED:n,CONTEXTMENU_ENABLED:r}}H(Z,M);Z.prototype.__defineGetter__("config",s("T"));Z.prototype.__defineGetter__("leftButtonDown",s("Ya"));
Z.prototype.__defineGetter__("middleButtonDown",s("sb"));Z.prototype.__defineGetter__("rightButtonDown",s("zb"));
Z.prototype.ka=function(){this.T.MOUSEWHEEL_ENABLED?(this.ne=new Td(this.ic),this.Ff=L(this.ne,"mousewheel",this.dd.bind(this))):(sc(this.Ff),this.ne=p);this.T.MOUSECLICKS_ENABLED?(this.Bf=L(this.ic,"mousedown",this.Th.bind(this)),this.Ef=L(this.ic,"mouseup",this.Yh.bind(this))):(sc(this.Bf),sc(this.Ef));this.ic.oncontextmenu=this.T.CONTEXTMENU_ENABLED?p:function(){return r};window.onkeydown=this.T.KEYBOARD_ENABLED?this.rg.bind(this):p;sc(this.Cf);sc(this.Df);this.Cf=L(this.ic,"mousemove",this.Vh.bind(this));
this.Df=L(this.ic,"mouseout",this.Wh.bind(this))};Z.prototype.Th=function(a){0==a.button?this.Ya=n:1==a.button?this.sb=n:2==a.button&&(this.zb=n);eval("this.onMouseDown("+this.Ya+","+this.sb+","+this.zb+")");me(this);a.preventDefault()};Z.prototype.Sh=ca();Z.prototype.Yh=function(a){0==a.button?this.Ya=r:1==a.button?this.sb=r:2==a.button&&(this.zb=r);eval("this.onMouseUp("+this.Ya+","+this.sb+","+this.zb+")");me(this);a.preventDefault()};Z.prototype.__defineGetter__("mousePosition",s("vd"));t=Z.prototype;
t.Xh=ca();t.Wh=function(a){this.me=r;this.T.KEYBOARD_ENABLED&&(window.onkeydown=p);this.zb=this.sb=this.Ya=r;me(this);this.he=new Uc(0,0);a.preventDefault()};t.Uh=ca();
t.Vh=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.me=n;this.T.KEYBOARD_ENABLED&&window.onkeydown==p&&(window.onkeydown=this.rg.bind(this));a.preventDefault();var b=a.shiftKey;this.vd=[a.offsetX,a.offsetY];var c=new Uc(this.vd[0],this.vd[1]),a=this.he.gb(c);this.he=c.f();this.T.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.sb||this.Ya||this.zb)&&me(this),this.Oe=setTimeout(function(){me(this);var a=new Hd;a.Cd=c.x;a.Dd=c.y;this.dispatchEvent(a);
this.Oe=p}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.bc()&&(this.Ya&&!b?(b=new Dd,b.U=a,this.dispatchEvent(b)):this.sb||this.Ya&&b?(b=new Cd,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.U=a,this.dispatchEvent(b)):this.zb&&(b=new Ed,b.Kb=0<a.y,b.jb=r,this.dispatchEvent(b)))};function me(a){a.Oe&&clearTimeout(a.Oe);a.dispatchEvent(new Id)}t.Zh=ca();t.dd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");me(this);a.preventDefault()};
t.Qh=ca();
t.rg=function(a){if(this.me){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");me(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Jd,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Cd:b?a=new Ed:(a=new Dd,this instanceof ne&&(a=new Fd)),a&&(c=new Uc(0,0),37==f?(c.x=5,a.J=r,b&&(a.J=n,a.Kb=n,a.jb=r)):39==f?(c.x=-5,a.J=n,b&&(a.Kb=r,a.jb=r)):38==f?(c.y=5,a.J=n,b&&(a.Kb=n,a.jb=n)):40==f&&(c.y=-5,a.J=r,b&&(a.Kb=r,
a.jb=n)),a.U=c,this.dispatchEvent(a)))}};E("X.interactor",Z);E("X.interactor.prototype.init",Z.prototype.ka);E("X.interactor.prototype.onMouseDown",Z.prototype.Sh);E("X.interactor.prototype.onMouseUp",Z.prototype.Xh);E("X.interactor.prototype.onMouseMove",Z.prototype.Uh);E("X.interactor.prototype.onMouseWheel",Z.prototype.Zh);E("X.interactor.prototype.onKey",Z.prototype.Qh);function ne(a){Z.call(this,a);this.c="interactor2D"}H(ne,Z);ne.prototype.dd=function(a){ne.i.dd.call(this,a);var b=new Fd;y(a.qc)||(a.qc=0);b.J=0>a.qc;this.dispatchEvent(b)};function oe(a){V.call(this);this.c="slice";this.l=[0,0,0];this.kc=[0,0,1];this.J=[0,1,0];this.G=this.K=10;this.Wb=[0,1,0,0,1,1,1,1,1,0,0,0];this.n=this.bb=p;this.Ra=n;this.fc=[1,1,1];y(a)&&this.Yb(a)}H(oe,V);oe.prototype.Yb=function(a){this.l=a.l.slice();this.kc=a.kc.slice();this.J=a.J.slice();this.K=a.K;this.G=a.G;this.bb=a.bb;this.n=a.n;this.Ra=a.Ra;this.fc=a.fc;this.Vg=a.Vg;oe.i.Yb.call(this,a)};
oe.prototype.pc=function(){var a=new O(this.kc[0],this.kc[1],this.kc[2]),b=new O(this.J[0],this.J[1],this.J[2]),c=Rc(b,a),d=new O(this.l[0],this.l[1],this.l[2]),e=new O(1,1,1);1==a.x?(e=new O(this.l[0],this.G/2,this.K/2),this.Wb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new O(this.K/2,this.l[1],this.G/2),this.Wb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new O(this.K/2,this.G/2,this.l[2]));var f=Qc(c.f().W(),b.f().W()),f=new O(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Qc(c.f().W(),b),g=new O(g.x*e.x,g.y*e.y,
g.b*e.b);g.add(d);var h=Qc(c,b.f().W()),h=new O(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var l=h,b=Qc(c,b),b=new O(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.g=new S(18);this.h=new S(18);this.g.add(f.x,f.y,f.b);this.g.add(g.x,g.y,g.b);this.g.add(h.x,h.y,h.b);this.g.add(l.x,l.y,l.b);this.g.add(b.x,b.y,b.b);this.g.add(d.x,d.y,d.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.Ra&&(a=new V,a.g=new S(24),a.h=
new S(24),a.g.add(f.x,f.y,f.b),a.g.add(g.x,g.y,g.b),a.g.add(g.x,g.y,g.b),a.g.add(b.x,b.y,b.b),a.g.add(b.x,b.y,b.b),a.g.add(h.x,h.y,h.b),a.g.add(h.x,h.y,h.b),a.g.add(f.x,f.y,f.b),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.Fb=[this.fc[0],this.fc[1],this.fc[2]],a.ja="LINES",a.mc=2,this.d.push(a))};E("X.slice",oe);function N(a){V.call(this);this.c="volume";this.l=[0,0,0];this.Y=[10,10,10];this.H=[1,1,1];this.lb=[];this.Ec=this.ob=this.Dc=this.nb=this.Cc=this.mb=0;this.O=new V;this.P=new V;this.$a=new V;this.Bd=this.Ja=r;this.Ab=0;this.n=p;this.Ra=n;this.ea=Infinity;this.da=-Infinity;ya(this,new Mc);ya(this,new kd);y(a)&&this.Yb(a)}H(N,V);
N.prototype.Yb=function(a){window.console.log(a);this.l=a.l.slice();this.Y=a.Y.slice();this.H=a.H.slice();this.mb=a.mb;this.Cc=a.Cc;this.nb=a.nb;this.Dc=a.Dc;this.ob=a.ob;this.Ec=a.Ec;this.O=new V(a.O);this.P=new V(a.P);this.$a=new V(a.$a);this.Ja=a.Ja;this.Bd=a.Bd;this.Ab=a.Ab;this.n=a.n;this.Ra=a.Ra;N.i.Yb.call(this,a)};
N.prototype.pc=function(){this.d.length=0;this.O.d.length=0;this.P.d.length=0;this.$a.d.length=0;this.d.push(this.O);this.d.push(this.P);this.d.push(this.$a);for(var a=0,a=0;3>a;a++){for(var b=(this.Y[a]-1)/2,c=b,d=0,d=0;d<this.Y[a];d++){var e=-b*this.H[a]+d*this.H[a],f=[[this.l[0]+e,this.l[1],this.l[2]],[this.l[0],this.l[1]+e,this.l[2]],[this.l[0],this.l[1],this.l[2]+e]],e=this.d[a].d,g=0,h=0,l=[1,1,1],k=this.Ra;0==a?(g=this.Y[2]*this.H[2]-this.H[2],h=this.Y[1]*this.H[1]-this.H[1],l=[1,1,0]):1==
a?(g=this.Y[0]*this.H[0]-this.H[0],h=this.Y[2]*this.H[2]-this.H[2],l=[1,0,0]):2==a&&(g=this.Y[0]*this.H[0]-this.H[0],h=this.Y[1]*this.H[1]-this.H[1],l=[0,1,0]);y(this.bb)&&(k=r);var j=new oe,o=j,f=f[a],v=[[1,0,0],[0,1,0],[0,0,1]][a],q=[[0,1,0],[0,0,-1],[0,1,0]][a];(!y(f)||!z(f)||3!=f.length)&&i(Error("Invalid center."));(!y(v)||!z(v)||3!=v.length)&&i(Error("Invalid front direction."));(!y(q)||!z(q)||3!=q.length)&&i(Error("Invalid up direction."));D(g)||i(Error("Invalid width."));D(h)||i(Error("Invalid height."));
var w=r;y(k)&&(w=k);k=[1,1,1];y(l)&&(k=l);o.l=f;o.kc=v;o.J=q;o.K=g;o.G=h;o.Ra=w;o.fc=k;o.pc();j.bb=this;j.visible=d==Math.floor(c);e.push(j)}0==a?this.Cc=this.mb=c:1==a?this.Dc=this.nb=c:2==a&&(this.Ec=this.ob=c)}this.e=n};
N.prototype.o=function(a){a="undefined"!==typeof a?a:n;if(0<this.d.length)if(this.Ja!=this.Bd&&(this.Ja?(this.d[0].d[parseInt(this.mb,10)].visible=r,this.d[1].d[parseInt(this.nb,10)].visible=r,this.d[2].d[parseInt(this.ob,10)].visible=r):this.d[this.Ab].visible=r,this.e=n,this.Bd=this.Ja),this.Ja)pe(this,this.Ab);else for(var b=0,b=0;3>b;b++){var c=this.d[b],d=0,e=0;0==b?(d=this.mb,e=this.Cc,this.Cc=this.mb):1==b?(d=this.nb,e=this.Dc,this.Dc=this.nb):2==b&&(d=this.ob,e=this.Ec,this.Ec=this.ob);c.d[parseInt(e,
10)].visible=r;c=c.d[parseInt(d,10)];c.visible=n;c.V=1}a&&N.i.o.call(this)};N.prototype.__defineGetter__("dimensions",s("Y"));N.prototype.__defineGetter__("volumeRendering",s("Ja"));N.prototype.__defineSetter__("volumeRendering",function(a){this.Ja=a;this.o(r)});N.prototype.__defineSetter__("visible",da("ma"));N.prototype.__defineGetter__("center",s("l"));N.prototype.__defineSetter__("center",function(a){(!y(a)||!z(a)||3!=a.length)&&i(Error("Invalid center."));this.l=a});
N.prototype.__defineGetter__("image",s("lb"));N.prototype.__defineGetter__("labelmap",function(){this.n||(this.n=new qe(this));return this.n});N.prototype.__defineGetter__("indexX",s("mb"));N.prototype.__defineSetter__("indexX",function(a){D(a)&&0<=a&&a<this.O.d.length&&(this.mb=a,this.o(r))});N.prototype.__defineGetter__("indexY",s("nb"));N.prototype.__defineSetter__("indexY",function(a){D(a)&&0<=a&&a<this.P.d.length&&(this.nb=a,this.o(r))});N.prototype.__defineGetter__("indexZ",s("ob"));
N.prototype.__defineSetter__("indexZ",function(a){D(a)&&0<=a&&a<this.$a.d.length&&(this.ob=a,this.o(r))});N.prototype.__defineGetter__("windowLow",s("ea"));N.prototype.__defineSetter__("windowLow",da("ea"));N.prototype.__defineGetter__("windowHigh",s("da"));N.prototype.__defineSetter__("windowHigh",da("da"));N.prototype.__defineGetter__("borders",s("Ra"));N.prototype.__defineSetter__("borders",da("Ra"));
function pe(a,b){if(a.Ja&&(a.e||b!=a.Ab)){var c=a.d[a.Ab];c.visible=r;var c=a.d[b],d=c.d.length,e;for(e=0;e<d;e++)c.d[e].ma=n;a.Ab=b;a.e=r}}E("X.volume",N);E("X.volume.prototype.modified",N.prototype.o);function re(){W.call(this);this.c="parserSTL"}H(re,W);
re.prototype.parse=function(a,b,c){I.Ga(this.c+".parse");this.aa=c;var d=b.g,e=b.h;if("solid"==String.fromCharCode.apply(p,Y(this,"uchar",5))){b.g=d=new S(c.byteLength);b.h=e=new S(c.byteLength);var f=d,d=e,e=Y(this,"uchar",c.byteLength-5),c=e.length,g=r,h=r,l=0,k;for(k=0;k<c;k++)if(10==e[k]){if(g||h){var j=String.fromCharCode.apply(p,e.subarray(l,k)).split(" "),h=parseFloat(j[0]),o=parseFloat(j[1]),j=parseFloat(j[2]);g?(d.add(h,o,j),d.add(h,o,j),d.add(h,o,j)):f.add(h,o,j);h=g=r}}else 32==e[k-1]&&
(102==e[k]?(l=k+=13,g=n):118==e[k]&&(l=k+=7,h=n))}else{this.w=80;f=Y(this,"uint");b.g=d=new S(9*f);b.h=e=new S(9*f);for(c=c=0;c<f;c++)g=Y(this,"float",12),l=g[0],k=g[1],h=g[2],e.add(l,k,h),e.add(l,k,h),e.add(l,k,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.w+=2}I.Aa(this.c+".parse");f=new md;f.Z=b;f.s=a;this.dispatchEvent(f)};E("X.parserSTL",re);E("X.parserSTL.prototype.parse",re.prototype.parse);function se(a){function b(){wc+=8;return lb<va.length?va[lb++]:-1}function c(){var a;wc++;a=Ea&1;Ea>>=1;0==Ea&&(Ea=b(),a=Ea&1,Ea=Ea>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=P[b]>>8-a);return b}function e(a){x[C++]=a;if(G==w-1){var b=new Uint8Array(2*w);b.set(q);q=b;w*=2}q[G++]=a;32768==C&&(C=0)}function f(){this.Fd=this.Ed=0;this.Se=p}function g(){for(;;){if(db[sa]>=Vb)return-1;if(Wb[db[sa]]==sa)return db[sa]++;db[sa]++}}function h(){var a=Fa[ga],b;if(17==sa)return-1;ga++;
sa++;b=g();if(0<=b)a.Ed=b;else if(a.Ed=32768,h())return-1;b=g();if(0<=b)a.Fd=b,a.Se=p;else if(a.Fd=32768,a.Se=Fa[ga],a.Jj=ga,h())return-1;sa--;return 0}function l(a,b,c){Fa=a;ga=0;Wb=c;Vb=b;for(a=0;17>a;a++)db[a]=0;sa=0;return h()?-1:0}function k(a){for(var b,d,e=0,f=a[e];;)if(b=c()){if(!(f.Fd&32768))return f.Fd;f=f.Se;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.Ed&32768))return f.Ed;e++;f=a[e]}}function j(){var a,g,h,j,o;do if(a=c(),h=d(2),0==h){Ea=1;h=b();h|=b()<<8;for(b(),b();h--;)g=
b(),e(g)}else if(1==h)for(;;)if(h=P[d(7)]>>1,23<h?(h=h<<1|c(),199<h?(h-=128,h=h<<1|c()):(h-=48,143<h&&(h+=136))):h+=256,256>h)e(h);else if(256==h)break;else{var q;h-=257;o=d(J[h])+Q[h];h=P[d(5)]>>3;8<ba[h]?(q=d(8),q|=d(ba[h]-8)<<8):q=d(ba[h]);q+=T[h];for(h=0;h<o;h++)g=x[C-q&32767],e(g)}else if(2==h){var u=Array(320);g=257+d(5);q=1+d(5);j=4+d(4);for(h=0;19>h;h++)u[h]=0;for(h=0;h<j;h++)u[aa[h]]=d(3);o=eb.length;for(j=0;j<o;j++)eb[j]=new f;if(l(eb,19,u)){C=0;return}o=g+q;j=0;for(var v=-1;j<o;)if(v++,
h=k(eb),16>h)u[j++]=h;else if(16==h){var w;h=3+d(2);if(j+h>o){C=0;return}for(w=j?u[j-1]:0;h--;)u[j++]=w}else{h=17==h?3+d(3):11+d(7);if(j+h>o){C=0;return}for(;h--;)u[j++]=0}o=Cb.length;for(j=0;j<o;j++)Cb[j]=new f;if(l(Cb,g,u)){C=0;return}o=Cb.length;for(j=0;j<o;j++)eb[j]=new f;h=[];for(j=g;j<u.length;j++)h[j-g]=u[j];if(l(eb,q,h)){C=0;return}for(;;)if(h=k(Cb),256<=h){h-=256;if(0==h)break;h--;o=d(J[h])+Q[h];h=k(eb);8<ba[h]?(q=d(8),q|=d(ba[h]-8)<<8):q=d(ba[h]);for(q+=T[h];o--;)g=x[C-q&32767],e(g)}else e(h)}while(!a);
C=0;Ea=1}function o(){var a=[],c;u&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b());F&&v(va.byteLength);a[0]=b();if(8==a[0]){u=b();b();b();b();b();b();b();if(u&4){a[0]=b();a[2]=b();sa=a[0]+256*a[1];for(a=0;a<sa;a++)b()}if(u&8){a=0;for(mb=[];c=b();){if("7"==c||":"==c)a=0;a<dd-1&&(mb[a++]=c)}}if(u&16)for(;b(););u&2&&(b(),b());j();b();b();b();b();b();b();b();b();F&&v(va.byteLength)}}function v(a){w=a;q=new Uint8Array(a);
a=[];F=r;a[0]=b();a[1]=b();120==a[0]&&218==a[1]&&(j(),A[B]=Array(2),A[B][0]=q,A[B][1]="geonext.gxt",B++);31==a[0]&&139==a[1]&&(o(),A[B]=Array(2),A[B][0]=q,A[B][1]="file",B++);if(80==a[0]&&75==a[1]&&(F=n,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();u=b();u|=b()<<8;a=b();a|=b()<<8;b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();var c=b(),c=c|b()<<8,d=b(),d=d|b()<<8,e=0;for(mb=[];c--;){var f=b();"/"==f|":"==f?e=0:e<dd-1&&(mb[e++]=String.fromCharCode(f))}xc||(xc=mb);for(e=0;e<
d;)b(),e++;G=0;8==a&&(j(),A[B]=Array(2),A[B][0]=q,A[B][1]=mb.join(""),B++);o()}}var q=p,w=0,u,B=0,A=[],x=Array(32768),C=0,F=r,G=0,P=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,
22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,
175,111,239,31,159,95,223,63,191,127,255],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],J=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ba=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],aa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],va=a,lb=0,Ea=1,wc=0,dd=256,mb=[],xc,Cb=Array(288),eb=Array(32),
ga=0,Fa=p,sa=0,db=Array(17);db[0]=0;var Wb,Vb;se.prototype.pf=function(){v(va.byteLength);return q}};function te(){W.call(this);this.c="parserDCM"}H(te,W);te.prototype.parse=function(a,b,c){c=this.ed(c,b);if(c.Sd==c.Ua){var d=c.kf.length,e,f=0;for(e=0;e<d;e++){var g=c.kf[e];g!==m&&(g*=c.ib,g=c.Uc.subarray(g,g+c.ib),c.data.set(g,f*c.ib),f++)}b.Y=[c.ta[0],c.ta[1],c.ta[2]];b.H=[c.eb[0],c.eb[1],c.eb[2]];e=Ld(c.data);d=e[0];e=e[1];c.min=b.Ha=b.ea=d;c.max=b.Ba=b.da=e;-Infinity==b.ba&&(b.ba=d);Infinity==b.ca&&(b.ca=e);b.pc();b.lb=Md(this,b,c)}c=new md;c.Z=b;c.s=a;this.dispatchEvent(c)};
te.prototype.ed=function(a,b){this.aa=a;if(y(b.ec)){d=b.ec;f=d.fg;h=d.eg;this.w=2*f;var c=Y(this,"uchar",h),c=parseInt(String.fromCharCode.apply(p,c),10);d.ta[2]++}else{var d={rows:0,cols:0,eb:p,Be:0,ah:0,Ua:1,Oh:1,fg:0,eg:0,Sd:0,ib:0,Uc:p,ef:0,kf:[],data:p,min:Infinity,max:-Infinity};d.Ua=b.p.length;y(d.Ua)||(d.Ua=1);for(var e=Y(this,"ushort",this.aa.byteLength),f=66,g=h=p,h=p,c="",l=7;0<l;)if(h=e[f++],40==h)switch(g=e[f++],f++,h=e[f++],g){case 16:d.rows=e[f++];l--;break;case 17:d.cols=e[f++];l--;
break;case 256:d.Be=e[f++];l--;break;case 257:d.ah=e[f++];l--;break;case 2:d.Oh=e[f++];l--;break;case 48:for(var g="",k=0,k=0;k<h/2;k++)var j=e[f++],o=j&255,j=(j&65280)>>8,g=g+String.fromCharCode(o),g=g+String.fromCharCode(j);g=g.split("\\");d.eb=[+g[0],+g[1],1];l--}else if(32==h&&(g=e[f++],19==g)){f++;h=e[f++];d.fg=f;d.eg=h;for(k=0;k<h/2;k++)j=e[f++],o=j&255,j=(j&65280)>>8,c+=String.fromCharCode(o),c+=String.fromCharCode(j),c=parseInt(c,10);l--}b.ec=d;d.ta=[d.cols,d.rows,1];d.ib=d.rows*d.cols;switch(d.Be){case 8:d.Uc=
new Uint8Array(d.cols*d.rows*d.Ua);d.data=new Uint8Array(d.cols*d.rows*d.Ua);break;case 16:d.Uc=new Uint16Array(d.cols*d.rows*d.Ua);d.data=new Uint16Array(d.cols*d.rows*d.Ua);break;case 32:d.Uc=new Uint32Array(d.cols*d.rows*d.Ua),d.data=new Uint32Array(d.cols*d.rows*d.Ua)}}this.w=this.aa.byteLength-2*d.ib;e=p;switch(d.Be){case 8:e=Y(this,"uchar",d.ib);break;case 16:e=Y(this,"ushort",d.ib);break;case 32:e=Y(this,"uint",d.ib)}d.kf[c]=d.ef;d.Uc.set(e,d.ef*d.ib);d.ef++;++d.Sd;return d};
E("X.parserDCM",te);E("X.parserDCM.prototype.parse",te.prototype.parse);function ue(){W.call(this);this.c="parserVTK"}H(ue,W);
ue.prototype.parse=function(a,b,c){I.Ga(this.c+".parse");var d=b.g,e=b.h,f=new Uint8Array(c),g="";b.g=d=new S(c.byteLength);b.h=e=new S(c.byteLength);for(var c=0,h=f.length;c<h;c+=32768)g+=String.fromCharCode.apply(p,f.subarray(c,Math.min(c+32768,h)));f=g.split("\n");g=f.length;this.Qc=this.Rc=p;this.Ib=[];this.qa=jd;this.pe=this.vb=this.kb=this.wb=r;c=0;for(h=g%8;h--;)ve(this,f[c]),c++;for(h=0.125*g^0;h--;)ve(this,f[c]),c++,ve(this,f[c]),c++,ve(this,f[c]),c++,ve(this,f[c]),c++,ve(this,f[c]),c++,
ve(this,f[c]),c++,ve(this,f[c]),c++,ve(this,f[c]),c++;var c=this.Rc,f=this.Qc,g=f.length,l=h=this.Ib.length;do{var k=this.Ib[h-l],j=k.length,o;for(o=0;o<j&&!("LINES"==this.qa&&o+1>=j);o++){var v=parseInt(k[o],10),q=c.get(v);d.add(q[0],q[1],q[2]);var w=v,u=q;"LINES"==this.qa?(w=parseInt(k[o+1],10),u=c.get(w),d.add(u[0],u[1],u[2])):"TRIANGLE_STRIPS"==this.qa&&(0==o||o==j-1)&&d.add(q[0],q[1],q[2]);v<g?(u=f.get(v),e.add(u[0],u[1],u[2]),"LINES"==this.qa?(w=f.get(w),e.add(w[0],w[1],w[2])):"TRIANGLE_STRIPS"==
this.qa&&(0==o||o==j-1)&&e.add(u[0],u[1],u[2])):(w=new O(q[0],q[1],q[2]),w.normalize(),e.add(w.x,w.y,w.b),"LINES"==this.qa?(w=new O(u[0],u[1],u[2]),w.normalize(),e.add(w.x,w.y,w.b)):"TRIANGLE_STRIPS"==this.qa&&(0==o||o==j-1)&&e.add(w.x,w.y,w.b))}l--}while(0<l);b.ja=this.qa;I.Aa(this.c+".parse");d=new md;d.Z=b;d.s=a;this.dispatchEvent(d)};
function ve(a,b){var b=b.replace(/^\s+|\s+$/g,""),c=b.split(" "),d=c.length,e=c[0];switch(e){case "POINTS":a.wb=n;a.kb=r;a.vb=r;c=parseInt(c[1],10);a.Rc=new S(3*c);a.Qc=new S(3*c);return;case "VERTICES":a.kb=n;a.wb=r;a.vb=r;c=parseInt(c[1],10);3<=c?a.qa=jd:1==c?a.qa="POINTS":i(Error("This VTK file is not supported!"));a.Ib=[];return;case "TRIANGLE_STRIPS":a.kb=n;a.wb=r;a.vb=r;a.qa="TRIANGLE_STRIPS";a.Ib=[];return;case "LINES":a.kb=n;a.wb=r;a.vb=r;a.qa="LINES";a.Ib=[];return;case "POLYGONS":a.kb=n;
a.wb=r;a.vb=r;a.qa="POLYGONS";a.Ib=[];return;case "POINT_DATA":a.vb=n;a.wb=r;a.kb=r;return}if(a.wb)if(1==d||isNaN(parseFloat(e)))a.wb=r;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.Rc.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Rc.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Rc.add(d,e,c))}else a.kb?1==d||isNaN(parseFloat(e))?a.kb=r:a.Ib.push(c.slice(1)):a.vb&&("NORMALS"==e?a.pe=n:1==d||isNaN(parseFloat(e))?
(a.vb=r,a.pe=r):a.pe&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.Qc.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.Qc.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.Qc.add(d,e,c))))}E("X.parserVTK",ue);E("X.parserVTK.prototype.parse",ue.prototype.parse);function we(){W.call(this);this.c="parserFSM";this.sd=r}H(we,W);
we.prototype.parse=function(a,b,c){I.Ga(this.c+".parse");this.aa=c;var d=b.g,e=b.h,f=b.Mc,c=0,g;do g=Y(this,"uchar"),c++;while(200>c&&10!=g);Y(this,"uchar");var e=Y(this,"uint"),c=Y(this,"uint"),h=Y(this,"float",3*e);g=Y(this,"uint",3*c);var l=new Uint32Array(e),k=new Float32Array(9*c);b.g=d=new S(9*c);b.h=e=new S(9*c);var j;for(j=0;j<c;j++){var o=3*j,v=g[o],q=g[o+1],w=g[o+2];f.push(v);f.push(q);f.push(w);l[v]+=1;l[q]+=1;l[w]+=1;var o=3*v,u=3*q,B=3*w,A=h[o],x=h[o+1],C=h[o+2],q=h[u],w=h[u+1],v=h[u+
2],F=h[B],G=h[B+1],P=h[B+2];d.add(A,x,C);d.add(q,w,v);d.add(F,G,P);A=new O(A,x,C);F=new O(F,G,P);q=(new O(q,w,v)).f().gb(A);w=F.f().gb(A);q=Rc(q,w).normalize();k[o]+=q.x;k[o+1]+=q.y;k[o+2]+=q.b;k[u]+=q.x;k[u+1]+=q.y;k[u+2]+=q.b;k[B]+=q.x;k[B+1]+=q.y;k[B+2]+=q.b}for(j=0;j<c;j++)o=3*j,v=g[o],q=g[o+1],w=g[o+2],o=3*v,u=3*q,B=3*w,f=new O(k[u],k[u+1],k[u+2]),h=new O(k[B],k[B+1],k[B+2]),o=(new O(k[o],k[o+1],k[o+2])).scale(1/l[v]).normalize(),f=f.scale(1/l[q]).normalize(),h=h.scale(1/l[w]).normalize(),e.add(o.x,
o.y,o.b),e.add(f.x,f.y,f.b),e.add(h.x,h.y,h.b);b.ja=jd;I.Aa(this.c+".parse");c=new md;c.Z=b;c.s=a;this.dispatchEvent(c)};E("X.parserFSM",we);E("X.parserFSM.prototype.parse",we.prototype.parse);function xe(){W.call(this);this.c="parserMGZ";this.sd=r}H(xe,W);xe.prototype.parse=function(a,b,c,d){I.Ga(this.c+".parse");var e=c;d&&(e=(new se(new Uint8Array(c))).pf(),e=e.buffer);c=this.ed(e);b.Y=[c.Ve,c.We,c.Xe];b.H=c.Jg;d=c.min;e=c.max;b.Ha=b.ea=d;b.Ba=b.da=e;-Infinity==b.ba&&(b.ba=d);Infinity==b.ca&&(b.ca=e);b.pc();I.Aa(this.c+".parse");b.lb=Md(this,b,c);c=new md;c.Z=b;c.s=a;this.dispatchEvent(c)};
xe.prototype.ed=function(a){this.aa=a;a={version:0,Qg:0,Og:0,sh:0,Pg:0,Ve:0,We:0,Xe:0,Nh:0,type:0,lh:0,Ag:0,$i:p,Ng:p,Jg:p,data:p,min:Infinity,max:-Infinity};a.version=Y(this,"uint");a.Ve=Y(this,"uint");a.We=Y(this,"uint");a.Xe=Y(this,"uint");a.Nh=Y(this,"uint");a.type=Y(this,"uint");a.lh=Y(this,"uint");a.Ag=Y(this,"ushort");if(0<a.Ag){a.Jg=Y(this,"float",3);var b=[];b.push(Y(this,"float",3));b.push(Y(this,"float",3));b.push(Y(this,"float",3));b.push(Y(this,"float",3));a.Ng=b}this.w=284;b=a.Ve*a.We*
a.Xe;switch(a.type){case 0:a.data=Y(this,"uchar",b);break;case 1:a.data=Y(this,"uint",b);break;case 3:a.data=Y(this,"float",b);break;case 4:a.data=Y(this,"ushort",b);break;default:i(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Ld(a.data);a.min=b[0];a.max=b[1];this.w+16<this.aa.byteLength&&(a.Qg=Y(this,"float"),a.sh=Y(this,"float"),a.Og=Y(this,"float"),a.Pg=Y(this,"float"));return a};E("X.parserMGZ",xe);E("X.parserMGZ.prototype.parse",xe.prototype.parse);function ye(){W.call(this);this.c="parserCRV";this.sd=r}H(ye,W);
ye.prototype.parse=function(a,b,c){I.Ga(this.c+".parse");var d=b.Mc;0==d.length&&i(Error("No _pointIndices defined on the X.object."));this.aa=c;this.w=3;var e=Y(this,"uint");Y(this,"uint");Y(this,"uint");var f=0,g=0,h=0,l=0,k=0,j=0,o=0,v=0,q=0,w=0,u=0,c=Array(2),B=Array(2),A=Y(this,"float",e),x;for(x=0;x<e;x++){var C=A[x];0==x&&(c[0]=B[0]=C);0<=C?(f++,l+=C):(g++,h+=C);q+=C;u++;B[0]=Math.max(C,B[0]);c[0]=Math.min(C,c[0]);A[x]=C}0!=f&&(k=l/f);0!=g&&(j=h/g);0!=u&&(w=q/u);for(u=q=h=l=0;u<e;u++)C=A[u],
x=0,0<=C?(x=Math.pow(C-k,2),l+=x):(x=Math.pow(C-j,2),h+=x),x=Math.pow(C-w,2),q+=x;1<f&&(o=Math.sqrt(l/(f-1)));1<g&&(v=Math.sqrt(h/(g-1)));c[1]=j-2.5*v;B[1]=k+2.5*o;e=d.length;f=new Float32Array(3*e);for(u=0;u<e;u++)g=A[d[u]],h=3*u,f[h]=g,f[h+1]=g,f[h+2]=g;b.t.Ha=c[1];b.t.Ba=B[1];-Infinity==b.t.ba&&(b.t.ba=c[1]);Infinity==b.t.ca&&(b.t.ca=B[1]);b.t.u=A;b.t.Bc=f;b.t.e=n;I.Aa(this.c+".parse");d=new md;d.Z=b;d.s=a;this.dispatchEvent(d)};E("X.parserCRV",ye);E("X.parserCRV.prototype.parse",ye.prototype.parse);function ze(){W.call(this);this.c="parserTRK"}H(ze,W);
ze.prototype.parse=function(a,b,c){I.Ga(this.c+".parse");var d=b.g,e=b.h,f=b.S;this.aa=c;Y(this,"uchar",6);Y(this,"ushort",3);var g=Y(this,"float",3);Y(this,"float",3);Y(this,"ushort");Y(this,"uchar",200);Y(this,"ushort");Y(this,"uchar",200);Y(this,"float",16);Y(this,"uchar",444);Y(this,"uchar",4);Y(this,"uchar",4);Y(this,"float",6);Y(this,"uchar",2);Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");Y(this,"uchar");var h=Y(this,"uint");Y(this,"uint");var l=Y(this,"uint"),
k=[],j=[],c=Infinity,o=-Infinity,v=p,q=p,w=p,u=p,e=d=p,B=Y(this,"uint",(this.aa.byteLength-1E3)/4);this.w=l;for(var A=Y(this,"float",(this.aa.byteLength-1E3)/4),x=0,l=f=0;l<h;l++){for(var C=B[x],F=new S(3*C),G=0,P=0;P<C;P++){var Q=A[x+3*P+1],J=A[x+3*P+2],T=A[x+3*P+3],Q=Q/g[0],J=J/g[1],T=T/g[2];F.add(Q,J,T);if(0<P)var ba=F.get(P-1),G=G+Math.sqrt(Math.pow(Q-ba[0],2)+Math.pow(J-ba[1],2)+Math.pow(T-ba[2],2));P<C-1&&(f+=6)}x+=3*C+1;P=F.Pb;C=F.Mb;Q=F.Qb;J=F.Nb;T=F.Rb;ba=F.Ob;if(!v||P<v)v=P;if(!q||C>q)q=
C;if(!w||Q<w)w=Q;if(!u||J>u)u=J;if(!d||T<d)d=T;if(!e||ba>e)e=ba;k.push(F);j.push(G)}g=(v+q)/2;w=(w+u)/2;v=(d+e)/2;u=new Float32Array(f);b.g=d=new S(f);b.h=e=new S(f);b.S=f=new S(f);for(l=q=0;l<h;l++){B=k[l];A=B.count;G=j[l];c=Math.min(c,G);o=Math.max(o,G);for(P=0;P<A-1;P++){F=B.get(P);x=B.get(P+1);d.add(F[0],F[1],F[2]);d.add(x[0],x[1],x[2]);var C=F[0]-g,Q=F[1]-w,J=F[2]-v,T=Math.sqrt(C*C+Q*Q+J*J),ba=x[0]-g,aa=x[1]-w,va=x[2]-v,lb=Math.sqrt(ba*ba+aa*aa+va*va);e.add(C/T,Q/T,J/T);e.add(ba/lb,aa/lb,va/
lb);x=[Math.abs(x[0]-F[0]),Math.abs(x[1]-F[1]),Math.abs(x[2]-F[2])];F=Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2]);x[0]/=F;x[1]/=F;x[2]/=F;f.add(x[0],x[1],x[2]);f.add(x[0],x[1],x[2]);u[q++]=G;u[q++]=G;u[q++]=G;u[q++]=G;u[q++]=G;u[q++]=G}}b.ja="LINES";h=new ld;h.Ha=c;h.Ba=o;h.ba=c;h.ca=o;h.Bc=u;h.Jf=r;h.e=n;b.t=h;I.Aa(this.c+".parse");c=new md;c.Z=b;c.s=a;this.dispatchEvent(c)};E("X.parserTRK",ze);E("X.parserTRK.prototype.parse",ze.prototype.parse);function Ae(){W.call(this);this.c="parserIMAGE"}H(Ae,W);Ae.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||i(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;qc(f,"load",this.hi.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};Ae.prototype.hi=function(a,b,c){b.lb=a;b.sa=p;a=new md;a.Z=c;a.s=b;this.dispatchEvent(a)};E("X.parserIMAGE",Ae);E("X.parserIMAGE.prototype.parse",Ae.prototype.parse);function Be(){W.call(this);this.c="parserLUT"}H(Be,W);
Be.prototype.parse=function(a,b,c){I.Ga(this.c+".parse");this.aa=c;var c=Y(this,"uchar",c.byteLength),d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=String.fromCharCode.apply(p,c.subarray(e,f)),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}I.Aa(this.c+".parse");c=new md;
c.Z=b;c.s=a;this.dispatchEvent(c)};E("X.parserLUT",Be);E("X.parserLUT.prototype.parse",Be.prototype.parse);function Ce(){W.call(this);this.c="parserNRRD"}H(Ce,W);
Ce.prototype.parse=function(a,b,c){I.Ga(this.c+".parse");this.aa=c;var c=Y(this,"uchar",c.byteLength),d=c.length,e=p,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=String.fromCharCode.apply(p,c.subarray(0,g-2));f=g+1;break}var h,l,k,j,d=e.split(/\r?\n/);for(e=0,g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.Jh=n;else if(!h.match(/^#/)&&(j=h.match(/(.*):(.*)/)))l=j[1].trim(),h=j[2].trim(),(k=this.oh[l])?k.call(this,h):this[l]=h;this.Jh||i(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==
this.encoding&&"gz"!==this.encoding&&i(Error("Only raw or gz/gzip encoding is allowed"));if(!this.Fa&&(this.Fa=[new O(1,0,0),new O(0,1,0),new O(0,0,1)],this.lf)){d=[];for(j=0;2>=j;j++)d.push(!isNaN(this.lf[j])?this.Fa[j].scale(this.lf[j]):m)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new se(f)).pf();f=f.buffer;c={data:p,min:Infinity,max:-Infinity};c.data=new this.Eb(f);j=Ld(c.data);f=c.min=j[0];j=c.max=j[1];b.Y=[this.hf[0],this.hf[1],this.hf[2]];b.H=[(new O(this.Fa[0][0],this.Fa[0][1],
this.Fa[0][2])).bc(),(new O(this.Fa[1][0],this.Fa[1][1],this.Fa[1][2])).bc(),(new O(this.Fa[2][0],this.Fa[2][1],this.Fa[2][2])).bc()];b.Ha=b.ea=f;b.Ba=b.da=j;-Infinity==b.ba&&(b.ba=f);Infinity==b.ca&&(b.ca=j);b.pc();I.Aa(this.c+".parse");b.lb=Md(this,b,c);c=new md;c.Z=b;c.s=a;this.dispatchEvent(c)};
Ce.prototype.oh={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Eb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Eb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Eb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Eb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Eb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Eb=Uint32Array;break;case "float":this.Eb=Float32Array;break;default:i(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.ta=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.hf=e},"space directions":function(a){var b,
c,d;c=a.match(/\(.*?\)/g);return this.Fa=function(){var a,f,g;g=[];for(a=0,f=c.length;a<f;a++)d=c[a],g.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return g}()},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.lf=e}};E("X.parserNRRD",Ce);E("X.parserNRRD.prototype.parse",Ce.prototype.parse);function De(){W.call(this);this.c="parserNII"}H(De,W);De.prototype.parse=function(a,b,c){I.Ga(this.c+".parse");var d=c;348!=(new Uint32Array(c,0,1))[0]&&(d=(new se(new Uint8Array(c))).pf(),d=d.buffer);c=this.ed(d);b.Y=[c.ta[1],c.ta[2],c.ta[3]];b.H=[c.eb[1],c.eb[2],c.eb[3]];var d=c.min,e=c.max;b.Ha=b.ea=d;b.Ba=b.da=e;-Infinity==b.ba&&(b.ba=d);Infinity==b.ca&&(b.ca=e);b.pc();I.Aa(this.c+".parse");b.lb=Md(this,b,c);c=new md;c.Z=b;c.s=a;this.dispatchEvent(c)};
De.prototype.ed=function(a){this.aa=a;a={Ei:0,fh:p,gh:p,nh:0,yi:0,qi:0,jh:p,ta:p,Eh:0,Fh:0,Gh:0,Ch:0,Je:0,$g:0,Ii:0,eb:p,Kg:0,xi:0,wi:0,Hi:0,Fi:p,Wi:p,bh:0,dh:0,Gi:0,Pi:0,uh:0,vh:0,ih:p,Zg:p,ji:0,Ci:0,ni:0,oi:0,pi:0,ki:0,li:0,mi:0,Ji:p,Ki:p,Li:p,Dh:p,Kh:p,data:p,min:Infinity,max:-Infinity};a.Ei=Y(this,"uint");a.fh=Y(this,"uchar",10);a.gh=Y(this,"uchar",18);a.nh=Y(this,"uint");a.yi=Y(this,"ushort");a.qi=Y(this,"uchar");a.jh=Y(this,"uchar");a.ta=Y(this,"ushort",8);a.Eh=Y(this,"float");a.Fh=Y(this,"float");
a.Gh=Y(this,"float");a.Ch=Y(this,"ushort");a.Je=Y(this,"ushort");a.$g=Y(this,"ushort");a.Ii=Y(this,"ushort");a.eb=Y(this,"float",8);a.Kg=Y(this,"float");a.xi=Y(this,"float");a.wi=Y(this,"float");a.Hi=Y(this,"ushort");a.Fi=Y(this,"uchar");a.Wi=Y(this,"uchar");a.bh=Y(this,"float");a.dh=Y(this,"float");a.Gi=Y(this,"float");a.Pi=Y(this,"float");a.uh=Y(this,"uint",1);a.vh=Y(this,"uint",1);a.ih=Y(this,"uchar",80);a.Zg=Y(this,"uchar",24);a.ji=Y(this,"ushort");a.Ci=Y(this,"ushort");a.ni=Y(this,"float");a.oi=
Y(this,"float");a.pi=Y(this,"float");a.ki=Y(this,"float");a.li=Y(this,"float");a.mi=Y(this,"float");a.Ji=Y(this,"float",4);a.Ki=Y(this,"float",4);a.Li=Y(this,"float",4);a.Dh=Y(this,"uchar",16);a.Kh=Y(this,"uchar",4);this.w=parseInt(a.Kg,10);var b=a.ta[1]*a.ta[2]*a.ta[3];switch(a.Je){case 2:a.data=Y(this,"uchar",b);break;case 4:a.data=Y(this,"sshort",b);break;case 8:a.data=Y(this,"sint",b);break;case 16:a.data=Y(this,"float",b);break;case 256:a.data=Y(this,"schar",b);break;case 512:a.data=Y(this,"ushort",
b);break;case 768:a.data=Y(this,"uint",b);break;default:i(Error("Unsupported NII data type: "+a.Je))}b=Ld(a.data);a.min=b[0];a.max=b[1];return a};E("X.parserNII",De);E("X.parserNII.prototype.parse",De.prototype.parse);function Ee(){M.call(this);this.c="loader";this.lc=new Kb;this.Oc=0}H(Ee,M);function Fe(a,b){a.Oc+=b/a.lc.cb()/3;a.Oc=Math.min(1,a.Oc);var c=new Kd;c.Kf=a.Oc;a.dispatchEvent(c)}function Ge(a){var a=a.p.wd,b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in He||i(Error("The "+b+" file format is not supported."));return[a,b,He[b][0],He[b][1],He[b][2]]}
Ee.prototype.load=function(a,b){(!a||!b)&&i(Error("No container or object to load."));if(!Mb(this.lc.D,a.pa)||this.lc.get(a.pa)){this.lc.set(a.pa,r);var c=Ge(a)[0];if(a.Hb!=p)this.parse(p,a,b);else{var d=new XMLHttpRequest;L(d,"abort",this.Wf.bind(this,d,a,b));L(d,"error",this.Wf.bind(this,d,a,b));L(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,n);d.responseType="arraybuffer";d.send(p)}}};
Ee.prototype.parse=function(a,b,c){Fe(this,1);setTimeout(function(){var d=Ge(b),e=d[3],d=new d[2];qc(d,yc,this.complete.bind(this));var f=b.Hb;f==p&&(f=a.response);d.parse(b,c,f,e)}.bind(this),100)};Ee.prototype.complete=function(a){Fe(this,1);setTimeout(function(){var b=a.s,c=a.Z;b.p.e=r;b.e=n;b.Af=n;c.o();this.lc.set(b.pa,n)}.bind(this),100)};Ee.prototype.Wf=function(a,b,c){i(Error("Loading failed: ",b,c))};
var He={STL:[re,p],VTK:[ue,p],TRK:[ze,p],FSM:[we,p],INFLATED:[we,p],SMOOTHWM:[we,p],SPHERE:[we,p],PIAL:[we,p],ORIG:[we,p],NRRD:[Ce,p],NII:[De,p],GZ:[De,p],DCM:[te,p],DICOM:[te,p],"":[te,p],CRV:[ye,p],LABEL:[Sd,p],MGH:[xe,r],MGZ:[xe,n],TXT:[Be,p],LUT:[Be,p],PNG:[Ae,"png"],JPG:[Ae,"jpeg"],JPEG:[Ae,"jpeg"],GIF:[Ae,"gif"]};function Ie(a,b){(!D(a)||!D(b))&&i(Error("A camera needs valid width and height values."));M.call(this);this.c="camera";this.ra=new O(0,0,100);this.jc=new O(0,0,0);this.J=new O(0,1,0);this.m=this.Ud(this.ra,this.jc);this.Jb=new Float32Array(this.m.Da())}H(Ie,M);Ie.prototype.ci=function(a){a instanceof Dd||i(Error("Received no valid rotate event."));this.rotate(a.U)};Ie.prototype.gi=function(a){a instanceof Ed||i(Error("Received no valid zoom event."));a.Kb?this.Lg(a.jb):this.Mg(a.jb)};
Ie.prototype.$h=function(a){a instanceof Cd||i(Error("Received no valid pan event."));this.wg(a.U)};Ie.prototype.__defineGetter__("view",s("m"));Ie.prototype.__defineSetter__("view",function(a){(!y(a)||!(a instanceof R))&&i(Error("Invalid view matrix."));this.m=a;this.Jb=new Float32Array(this.m.Da())});Ie.prototype.__defineGetter__("position",function(){return[this.ra.x,this.ra.y,this.ra.b]});
Ie.prototype.__defineSetter__("position",function(a){(!y(a)||!z(a)||3!=a.length)&&i(Error("Invalid position."));this.ra=new O(a[0],a[1],a[2]);this.reset()});Ie.prototype.__defineGetter__("focus",function(){return[this.jc.x,this.jc.y,this.jc.b]});Ie.prototype.__defineSetter__("focus",function(a){(!y(a)||!z(a)||3!=a.length)&&i(Error("Invalid focus"));this.jc=new O(a[0],a[1],a[2]);this.reset()});Ie.prototype.__defineGetter__("up",function(){return[this.J.x,this.J.y,this.J.b]});
Ie.prototype.__defineSetter__("up",function(a){(!y(a)||!z(a)||3!=a.length)&&i(Error("Invalid up vector."));this.J=new O(a[0],a[1],a[2]);this.reset()});t=Ie.prototype;t.reset=function(){this.m=this.Ud(this.ra,this.jc);this.Jb=new Float32Array(this.m.Da())};t.rotate=function(a){z(a)&&2==a.length?a=new Uc(a[0],a[1]):a instanceof Uc||i(Error("Invalid distance vector for rotate operation."));return a};
t.wg=function(a){z(a)&&2==a.length?a=new Uc(a[0],a[1]):a instanceof Uc||i(Error("Invalid distance vector for pan operation."));a=new O(-a.x,a.y,0);a=ed(4).translate(a);this.m=new R(a.multiply(this.m));this.Jb=new Float32Array(this.m.Da())};t.Lg=function(a){var b=20;y(a)&&!a&&(b=1);a=new O(0,0,b);a=ed(4).translate(a);this.m=new R(a.multiply(this.m));this.Jb=new Float32Array(this.m.Da())};
t.Mg=function(a){var b=30;y(a)&&!a&&(b=1);a=new O(0,0,-b);a=ed(4).translate(a);this.m=new R(a.multiply(this.m));this.Jb=new Float32Array(this.m.Da())};t.Ud=function(a,b){(!(a instanceof O)||!(b instanceof O))&&i(Error("3D vectors required for calculating the view."));return ed(4)};E("X.camera",Ie);E("X.camera.prototype.pan",Ie.prototype.wg);E("X.camera.prototype.rotate",Ie.prototype.rotate);E("X.camera.prototype.zoomIn",Ie.prototype.Lg);E("X.camera.prototype.zoomOut",Ie.prototype.Mg);function Je(a){function b(a,b,d){b=2*b*Math.PI;b=l.Db(Math.cos(b)).uc(k.Db(Math.sin(b)));a=c.uc(e.Db(a)).uc(b.Db(f));d=b.Db(1-Math.abs(d)).uc(g.Db(d));return new Ec(a,d)}this.A=[];for(var a=a||{},c=new xa(a.start||[0,-1,0]),d=new xa(a.end||[0,1,0]),e=d.cd(c),f=a.Va||1,a=a.jf||16,g=e.kd(),h=0.5<Math.abs(g.y()),l=(new xa(h,!h,0)).He(g).kd(),k=l.He(g).kd(),h=new Ec(c,g.Ye()),d=new Ec(d,g.kd()),j=[],o=0;o<a;o++){var v=o/a,q=(o+1)/a;j.push(new Gc([h,b(0,v,-1),b(0,q,-1)]));j.push(new Gc([b(0,q,0),b(0,v,
0),b(1,v,0),b(1,q,0)]));j.push(new Gc([d,b(1,q,1),b(1,v,1)]))}return Jc(j)}H(Je,Ic);function Ke(){V.call(this);this.c="cylinder";this.we=[-10,-10,-10];this.ee=[10,10,10];this.Sb=10;this.Vb=32;ya(this,new od)}H(Ke,V);Ke.prototype.__defineGetter__("start",s("we"));Ke.prototype.__defineSetter__("start",function(a){(!y(a)||!z(a)||3!=a.length)&&i(Error("Invalid start"));this.we=a});Ke.prototype.__defineGetter__("end",s("ee"));Ke.prototype.__defineSetter__("end",function(a){(!y(a)||!z(a)||3!=a.length)&&i(Error("Invalid end"));this.ee=a});Ke.prototype.__defineGetter__("radius",s("Sb"));
Ke.prototype.__defineSetter__("radius",function(a){D(a)||i(Error("Invalid radius."));this.Sb=a});Ke.prototype.o=function(){qd(this,new Je({start:this.we,end:this.ee,Va:this.Sb,jf:this.Vb}));Ke.i.o.call(this)};E("X.cylinder",Ke);E("X.cylinder.prototype.modified",Ke.prototype.o);function Le(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new xa(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Ec(c.uc(e.Db(d)),e))}this.A=[];for(var a=a||{},c=new xa(a.De||[0,0,0]),d=a.Va||1,e=a.jf||16,a=a.Mi||8,f=[],g=[],h=0;h<e;h++)for(var l=0;l<a;l++)g=[],b(h/e,l/a),0<l&&b((h+1)/e,l/a),l<a-1&&b((h+1)/e,(l+1)/a),b(h/e,(l+1)/a),f.push(new Gc(g));return Jc(f)}H(Le,Ic);function Me(){V.call(this);this.c="sphere";this.l=[0,0,0];this.Sb=5;this.Vb=32;this.Xg=16;ya(this,new od)}H(Me,V);Me.prototype.__defineGetter__("center",s("l"));Me.prototype.__defineSetter__("center",function(a){(!y(a)||!z(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});Me.prototype.__defineGetter__("radius",s("Sb"));Me.prototype.__defineSetter__("radius",function(a){D(a)||i(Error("Invalid radius."));this.Sb=a});
Me.prototype.o=function(){qd(this,new Le({De:this.l,Va:this.Sb,jf:this.Vb,Mi:this.Xg}));Me.i.o.call(this)};E("X.sphere",Me);E("X.sphere.prototype.modified",Me.prototype.o);function qe(a){N.call(this);this.c="labelmap";this.bb=a}H(qe,N);qe.prototype.o=function(){var a=new md;a.Z=this;this.dispatchEvent(a);this.bb.o()};E("X.labelmap",qe);function Ne(a){this.A=[];var a=a||{},b=new xa(a.De||[0,0,0]),c=!a.Va?[1,1,1]:a.Va.length?a.Va:[a.Va,a.Va,a.Va];return Jc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Gc(a[0].map(function(e){e=new xa(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Ec(e,new xa(a[1]))}))}))}H(Ne,Ic);function Oe(){V.call(this);this.c="cube";this.l=[0,0,0];this.ke=this.je=this.ie=20;this.Wb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];ya(this,new od)}H(Oe,V);Oe.prototype.__defineGetter__("center",s("l"));Oe.prototype.__defineSetter__("center",function(a){(!y(a)||!z(a)||3!=a.length)&&i(Error("Invalid center"));this.l=a});Oe.prototype.__defineGetter__("lengthX",s("ie"));
Oe.prototype.__defineSetter__("lengthX",function(a){D(a)||i(Error("Invalid lengthX."));this.ie=a});Oe.prototype.__defineGetter__("lengthY",s("je"));Oe.prototype.__defineSetter__("lengthY",function(a){D(a)||i(Error("Invalid lengthY."));this.je=a});Oe.prototype.__defineGetter__("lengthZ",s("ke"));Oe.prototype.__defineSetter__("lengthZ",function(a){D(a)||i(Error("Invalid lengthZ."));this.ke=a});Oe.prototype.o=function(){qd(this,new Ne({De:this.l,Va:[this.ie/2,this.je/2,this.ke/2]}));Oe.i.o.call(this)};
E("X.cube",Oe);E("X.cube.prototype.modified",Oe.prototype.o);function Pe(a){Z.call(this,a);this.c="interactor3D"}H(Pe,Z);Pe.prototype.dd=function(a){Pe.i.dd.call(this,a);var b=new Ed;y(a.qc)||(a.qc=0);b.Kb=0>a.qc;b.jb=n;this.dispatchEvent(b)};function Qe(a){M.call(this);this.c="array";this.u=[];this.uf=a}H(Qe,M);Qe.prototype.add=function(a){this.u.push(a);return n};Qe.prototype.clear=function(){this.u.length=0};function Re(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);Re(a,b,d);for(Re(a,d,c);b<d;++b)if(0<a.uf(a.u[b],a.u[d])){var e=a.u[b];a.u[b]=a.u[d];for(var f=a,g=d,h=c;g+1<h&&0>f.uf(f.u[g+1],e);){var l=f,k=g+1,j=l.u[g];l.u[g]=l.u[k];l.u[k]=j;++g}f.u[g]=e}}}Qe.prototype.sort=function(){Re(this,0,this.u.length)};function Se(a,b){Ie.call(this,a,b);this.c="camera2D"}H(Se,Ie);Se.prototype.rotate=function(a){var a=Se.i.rotate.call(this,a),b=new Bd;0<a.x?b.ze--:0>a.x&&b.ze++;0<a.y?b.le++:0>a.y&&b.le--;this.dispatchEvent(b)};function Te(a,b){Ie.call(this,a,b);this.c="camera3D";this.vf=45;this.Gf=new Float32Array(Ue(this.vf,a/b).Da())}H(Te,Ie);function Ue(a,b){var c=1*Math.tan(a*Math.PI/360),d=-c;return new R([[2/(c*b-d*b),0,(c*b+d*b)/(c*b-d*b),0],[0,2/(c-d),(c+d)/(c-d),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]])}
Te.prototype.rotate=function(a){var a=Te.i.rotate.call(this,a),b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=ed(4),d=new O(parseFloat(this.m.R(0,0)),parseFloat(this.m.R(0,1)),parseFloat(this.m.R(0,2))),b=c.rotate(b,new O(parseFloat(this.m.R(1,0)),parseFloat(this.m.R(1,1)),parseFloat(this.m.R(1,2)))),a=c.rotate(a,d);this.m=new R(this.m.multiply(a.multiply(b)));this.Jb=new Float32Array(this.m.Da())};
Te.prototype.Ud=function(a,b){Te.i.Ud.call(this,a,b);var c=ed(4),d=new O(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.J.f();e.Vc(d)&&(e.b+=1.0E-6);var f=Rc(e,d),e=Rc(d,f),f=f.normalize(),e=e.normalize();c.k(0,0,f.x);c.k(0,1,f.y);c.k(0,2,f.b);c.k(0,3,0);c.k(1,0,e.x);c.k(1,1,e.y);c.k(1,2,e.b);c.k(1,3,0);c.k(2,0,d.x);c.k(2,1,d.y);c.k(2,2,d.b);c.k(2,3,0);c.k(3,0,0);c.k(3,1,0);c.k(3,2,0);c.k(3,3,1);d=a.f();return c.translate(d.W())};E("X.camera3D",Te);function Ve(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}Ve.prototype.f=function(){return new Ve(this.top,this.right,this.bottom,this.left)};Ve.prototype.contains=function(a){return!this||!a?r:a instanceof Ve?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function We(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}We.prototype.f=function(){return new We(this.left,this.top,this.width,this.height)};We.prototype.gg=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,n}return r};
We.prototype.contains=function(a){return a instanceof We?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};We.prototype.ua=function(){return new Vc(this.width,this.height)};function Xe(a,b){var c=$d(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,p))?c[b]||c.getPropertyValue(b):""}function Ye(a,b){return a.currentStyle?a.currentStyle[b]:p}function Ze(a,b){return Xe(a,b)||Ye(a,b)||a.style&&a.style[b]}function $e(a){a=a?9==a.nodeType?a:$d(a):document;return K&&!kb(9)&&!ke(Yd(a))?a.body:a.documentElement}
function af(a){var b=a.getBoundingClientRect();K&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function bf(a){if(K&&!kb(8))return a.offsetParent;for(var b=$d(a),c=Ze(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=Ze(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return p}
function cf(a){for(var b=new Ve(0,Infinity,Infinity,0),c=Yd(a),d=c.N.body,e=c.N.documentElement,f=!Ua&&"CSS1Compat"==c.N.compatMode?c.N.documentElement:c.N.body;a=bf(a);)if((!K||0!=a.clientWidth)&&(!Ua||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=Ze(a,"overflow")){var g=df(a),h;h=a;if(Ta&&!ib("1.9")){var l=parseFloat(Xe(h,"borderLeftWidth"));if(ef(h))var k=h.offsetWidth-h.clientWidth-l-parseFloat(Xe(h,"borderRightWidth")),l=l+k;h=new Sc(l,parseFloat(Xe(h,"borderTopWidth")))}else h=new Sc(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.N.parentWindow||c.N.defaultView||window;e=c.document;Ua&&!ib("500")&&!Va?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new Vc(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new Vc(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:p}
function df(a){var b,c=$d(a),d=Ze(a,"position"),e=Ta&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Sc(0,0),g=$e(c);if(a==g)return f;if(a.getBoundingClientRect)b=af(a),a=le(Yd(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(Ua&&"fixed"==Ze(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Sa||Ua&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=bf(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Sa||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function ff(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function gf(a){if("none"!=Ze(a,"display"))return hf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=hf(a);b.display=c;b.position=e;b.visibility=d;return a}function hf(a){var b=a.offsetWidth,c=a.offsetHeight,d=Ua&&!b&&!c;return(!ia(b)||d)&&a.getBoundingClientRect?(a=af(a),new Vc(a.right-a.left,a.bottom-a.top)):new Vc(b,c)}function jf(a,b){a.style.display=b?"":"none"}function ef(a){return"rtl"==Ze(a,"direction")}
function kf(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var lf={thin:2,medium:4,thick:6};function mf(a,b){if("none"==Ye(a,b+"Style"))return 0;var c=Ye(a,b+"Width");return c in lf?lf[c]:kf(a,c)};function nf(a){this.Na=a;this.v=[]}H(nf,Rb);var of=[];function pf(a,b,c,d,e){z(c)||(of[0]=c,c=of);for(var f=0;f<c.length;f++)a.v.push(L(b,c[f],d||a,e||r,a.Na||a))}nf.prototype.Xd=function(){ub(this.v,sc);this.v.length=0};nf.prototype.M=function(){nf.i.M.call(this);this.Xd()};nf.prototype.handleEvent=function(){i(Error("EventHandler.handleEvent not implemented"))};function qf(){}(function(a){a.Xf=function(){return a.Bh||(a.Bh=new a)}})(qf);qf.prototype.Ze=0;qf.Xf();function rf(a){this.Sa=a||Yd()}H(rf,Dc);t=rf.prototype;t.zh=qf.Xf();t.dg=p;t.ac=r;t.q=p;t.tc=p;t.Hd=p;t.Tc=p;t.Vi=r;t.j=s("q");t.gf=function(a){this.tc&&this.tc!=a&&i(Error("Method not supported"));rf.i.gf.call(this,a)};t.Ld=s("Sa");t.oc=function(){this.q=this.Sa.createElement("div")};t.dc=function(a){this.Cb(a)};t.Cb=function(a,b){this.ac&&i(Error("Component already rendered"));this.q||this.oc();a?a.insertBefore(this.q,b||p):this.Sa.N.body.appendChild(this.q);(!this.tc||this.tc.ac)&&this.Kd()};
t.Kd=function(){this.ac=n;sf(this,function(a){!a.ac&&a.j()&&a.Kd()})};t.Xc=function(){sf(this,function(a){a.ac&&a.Xc()});this.Pd&&this.Pd.Xd();this.ac=r};t.M=function(){rf.i.M.call(this);this.ac&&this.Xc();this.Pd&&(this.Pd.La(),delete this.Pd);sf(this,function(a){a.La()});!this.Vi&&this.q&&he(this.q);this.tc=this.q=this.Tc=this.Hd=p};function sf(a,b){a.Hd&&ub(a.Hd,b,m)}
t.removeChild=function(a,b){if(a){var c=ka(a)?a:a.dg||(a.dg=":"+(a.zh.Ze++).toString(36)),a=this.Tc&&c?(c in this.Tc?this.Tc[c]:m)||p:p;if(c&&a){var d=this.Tc;c in d&&delete d[c];yb(this.Hd,a);b&&(a.Xc(),a.q&&he(a.q));c=a;c==p&&i(Error("Unable to set parent component"));c.tc=p;rf.i.gf.call(c,p)}}a||i(Error("Child is not in parent component"));return a};function tf(){}H(tf,Dc);t=tf.prototype;t.qf=0;t.bd=0;t.Ue=100;t.Vf=0;t.mf=1;t.Ih=r;t.Mh=r;t.$d=function(a){a=uf(this,a);this.qf!=a&&(this.qf=a+this.Vf>this.Ue?this.Ue-this.Vf:a<this.bd?this.bd:a,!this.Ih&&!this.Mh&&this.dispatchEvent("change"))};t.Od=function(){return uf(this,this.qf)};t.Nd=function(){return uf(this,this.bd)};t.Md=function(){return uf(this,this.Ue)};function uf(a,b){return a.mf==p?b:a.bd+Math.round((b-a.bd)/a.mf)*a.mf};function vf(a){this.Sa=a||Yd();this.vc=new tf;L(this.vc,"change",this.wh,r,this)}H(vf,rf);var wf={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};t=vf.prototype;t.oc=function(){this.Qa=this.Ld().oc("div","progress-bar-thumb");var a=wf[this.vg];this.q=this.Ld().oc("div",a,this.Qa);xf(this);this.j().setAttribute("aria-valuemin",this.Nd());this.j().setAttribute("aria-valuemax",this.Md())};
t.Kd=function(){vf.i.Kd.call(this);K&&7>Za&&L(this.j(),"resize",this.be,r,this);this.be();var a=this.j();a.setAttribute("role","progressbar");a.Mj="progressbar";this.j().setAttribute("aria-live","polite")};t.Xc=function(){vf.i.Xc.call(this);yf(this)};function yf(a){K&&7>Za&&rc(a.j(),"resize",a.be,r,a)}t.Od=function(){return this.vc.Od()};t.$d=function(a){this.vc.$d(a);this.j()&&xf(this)};function xf(a){var b=a.Od();a.j().setAttribute("aria-valuenow",b)}t.Nd=function(){return this.vc.Nd()};t.Md=function(){return this.vc.Md()};
t.vg="horizontal";t.wh=function(){this.be();this.dispatchEvent("change")};t.be=function(){if(this.Qa){var a=this.Nd(),b=this.Md(),a=(this.Od()-a)/(b-a),b=Math.round(100*a);"vertical"==this.vg?K&&7>Za?(this.Qa.style.top=0,this.Qa.style.height="100%",b=this.Qa.offsetHeight,a=Math.round(a*b),this.Qa.style.top=b-a+"px",this.Qa.style.height=a+"px"):(this.Qa.style.top=100-b+"%",this.Qa.style.height=b+"%"):this.Qa.style.width=b+"%"}};t.M=function(){yf(this);vf.i.M.call(this);this.Qa=p;this.vc.La()};function zf(a,b){y(a)||i(Error("No valid parent element."));y(b)||i(Error("Invalid initial value."));vf.call(this);this.c="progressbar";this.Ca=a;this.pd=this.ab=p;this.Gb=[];this.Gb=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.$d(b);this.Qe()}H(zf,vf);
zf.prototype.Qe=function(){if("static"==this.Ca.style.position||""==this.Ca.style.position)this.Ca.style.position="relative";var a=document.getElementsByTagName("head")[0],b=de("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Gb[0]),d=document.createTextNode(this.Gb[1]),e=document.createTextNode(this.Gb[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.ab=b;this.dc(this.Ca);a=this.j();a.style.position="absolute";a.style.top=(this.Ca.clientHeight-
5)/2+"px";a.style.left=(this.Ca.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function Af(a){var b=a.j().style.top,c=a.j().style.left;he(a.j());var d=new zf(a.Ca,100),e=d.j();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=m?e.firstElementChild:ie(e.firstChild)).classList.add("progress-bar-thumb-done");a.pd=d}
zf.prototype.Rd=function(){this.ab&&he(this.ab);this.j()&&he(this.j());this.pd&&he(this.pd.j());this.pd=this.ab=p};var Bf=ea.window;function Cf(a,b,c){la(a)?c&&(a=ta(a,c)):a&&"function"==typeof a.handleEvent?a=ta(a.handleEvent,a):i(Error("Invalid listener argument"));return 2147483647<b?-1:Bf.setTimeout(a,b||0)};function Df(){M.call(this);this.c="renderer";this.s=window.document.body;this.K=this.s.clientWidth;this.G=this.s.clientHeight;this.Lb=this.r=this.ha=p;this.Za=new Qe(nd);this.Ia=[];this.B=p;this.qe=this.td=this.ud=r;this.a=this.la=p;this.T={PROGRESSBAR_ENABLED:n,INTERMEDIATE_RENDERING:r};this.sf=-1;window.console.log("XTK release 9 -- 2012-09-27 13:15:23 -- http://www.goXTK.com -- @goXTK")}H(Df,M);t=Df.prototype;t.ai=function(a){this.la&&this.la.$d(100*a.Kf)};
t.Rh=function(a){y(a)&&a instanceof md&&a.Z&&this.Wa(a.Z)};t.bf=function(a){(!y(a)||!(a instanceof Hd))&&i(Error("Invalid hover event."))};t.bi=function(){var a=ae(this.s);this.K=a.clientWidth;this.G=a.clientHeight;a=ae(this.ha);a.width=this.K;a.height=this.G;this instanceof Ef&&(this.a.viewport(0,0,this.K,this.G),this.r.Gf=new Float32Array(Ue(this.r.vf,this.ha.width/this.ha.height).Da()));this.xc()};t.cf=function(a){(!y(a)||!(a instanceof Fd))&&i(Error("Invalid scroll event."))};
Df.prototype.__defineGetter__("config",s("T"));Df.prototype.__defineGetter__("interactor",s("Lb"));Df.prototype.__defineGetter__("camera",s("r"));Df.prototype.__defineGetter__("loadingCompleted",s("td"));Df.prototype.__defineGetter__("container",s("s"));Df.prototype.__defineSetter__("container",function(a){y(a)||i(Error("An ID to a valid container (<div>..) is required."));var b=a;ka(b)&&(b=ae(a));ma(b)&&1==b.nodeType||i(Error("Could not find the given container."));this.s=b});t=Df.prototype;
t.xc=function(){this.r.reset()};function Ff(a){a.T.PROGRESSBAR_ENABLED&&a.la&&!a.tf&&(Af(a.la),a.tf=Cf(function(){this.tf=p;this.la&&(this.la.Rd(),this.la=p);this.dc()}.bind(a),700))}
t.ka=function(a){var b=de("canvas");this.s.appendChild(b);this.K=this.s.clientWidth;this.G=this.s.clientHeight;b.width=this.K;b.height=this.G;try{var c=b.getContext(a);c||i(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.s.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
i(Error(e))}this.B=new Ee;L(this.B,yd,this.ai.bind(this));this.ha=b;this.a=c;b=new Pe(this.ha);"2d"==a&&(b=new ne(this.ha));b.ka();L(b,wd,this.xc.bind(this));L(b,zd,this.bf.bind(this));L(b,vd,this.cf.bind(this));this.Lb=b;b=new Te(this.K,this.G);"2d"==a&&(b=new Se(this.K,this.G));a=b;c=this.Lb;(!y(c)||!(c instanceof Z))&&i(Error("Could not observe the interactor."));L(c,td,a.ci.bind(a));L(c,sd,a.$h.bind(a));L(c,ud,a.gi.bind(a));this.r=b;L(window,"resize",this.bi,r,this)};
t.add=function(a){(a instanceof Oe||a instanceof Me||a instanceof Ke)&&a.o();this.Ia.push(a);this.Wa(a)};t.Wa=function(a){(!this.ha||!this.a)&&i(Error("The renderer was not initialized properly."));y(a)||(window.console.log(a),i(Error("Illegal object.")));vc(a)||L(a,yc,this.Rh.bind(this))};t.get=function(a){y(a)||i(Error("Invalid object id."));for(var b=this.Za.u,c=b.length,d=0,d=0;d<c;d++)if(b[d].pa==a)return b[d];return p};
t.dc=function(){(!this.ha||!this.a)&&i(Error("The renderer was not initialized properly."));if(!y(this.If)){if(this.B.lc.Fe(r)){if(this.T.PROGRESSBAR_ENABLED&&!this.la&&(this.la=new zf(this.s,3)),this.qe=this.td=r,this.If=Cf(function(){this.If=p;this.dc()}.bind(this),100),!this.T.INTERMEDIATE_RENDERING)return}else if(!this.td&&!this.qe&&(this.qe=n,eval("this.onShowtime()"),this.td=n),this.la){Ff(this);return}this.sf=window.fd(this.dc.bind(this),this.ha);eval("this.onRender()");this.Cb(r,n)}};
t.ug=ca();t.sg=ca();t.Cb=ca();t.Jd=function(){window.Gd(this.sf);this.B&&(delete this.B,this.B=p);this.la&&(this.la.Rd(),delete this.la,this.la=p);this.Za.clear();delete this.Za;this.Ia.length=0;delete this.Ia;delete this.B;this.B=p;delete this.r;this.r=p;delete this.Lb;this.Lb=p;delete this.a;this.a=p;he(this.ha);delete this.ha;this.ha=p};function Gf(){M.call(this);this.c="shaders";this.Ad="";this.Ad="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\nattribute float vertexScalar;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform bool useScalars;\nuniform bool scalarsReplaceMode;\nuniform float scalarsMin;\nuniform float scalarsMax;\nuniform vec3 scalarsMinColor;\nuniform vec3 scalarsMaxColor;\nuniform float scalarsMinThreshold;\nuniform float scalarsMaxThreshold;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  fVertexNormal = vertexNormal;\n  fDiscardNow = 0.0;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useScalars) {\n    float scalarValue = vertexScalar;\n    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n      if (scalarsReplaceMode) {\n        fragmentColor = objectColor;\n      } else {\n        fDiscardNow = 1.0;\n      }\n    } else {\n      if (scalarsReplaceMode) {\n        fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n      } else {\n        fragmentColor = vertexColor;\n      }\n    }\n  } else if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.qd="";this.qd="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform bool volumeTexture;\nuniform bool useLabelMapTexture;\nuniform sampler2D textureSampler;\nuniform sampler2D textureSampler2;\nuniform float objectOpacity;\nuniform float labelmapOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\nuniform vec3 volumeScalarMinColor;\nuniform vec3 volumeScalarMaxColor;\nuniform float volumeWindowLow;\nuniform float volumeWindowHigh;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (fDiscardNow > 0.0) {\n   discard;\n }\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n   vec4 textureSum = texture1;\n   if (volumeTexture) {\n     float _windowLow = (volumeWindowLow / volumeScalarMax);\n     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n     vec3 fac = _maxrange - _minrange;\n     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n   }\n   if (useLabelMapTexture) {\n     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n     if (texture2.a > 0.0) {\n       if (labelmapOpacity < 1.0) {\n         textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n       } else {\n         textureSum = texture2;\n       }\n     }\n   }\n   if (volumeTexture) {\n     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n     if (texture1.r < _volumeLowerThreshold ||\n         texture1.r > _volumeUpperThreshold) {\n       discard;\n     };\n   };\n   gl_FragColor = textureSum;\n   gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n     gl_FragColor = vec4(fragmentColor,1.0);\n     return;\n   }\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
H(Gf,M);
var Hf={wj:"vertexPosition",vj:"vertexNormal",uj:"vertexColor",yj:"vertexTexturePos",xj:"vertexScalar"},If={zj:"view",ej:"perspective",Xi:"center",dj:"objectTransform",qj:"useObjectColor",bj:"objectColor",sj:"useScalars",mj:"scalarsReplaceMode",jj:"scalarsMin",gj:"scalarsMax",kj:"scalarsMinColor",hj:"scalarsMaxColor",lj:"scalarsMinThreshold",ij:"scalarsMaxThreshold",fj:"pointSize",cj:"objectOpacity",aj:"normal",rj:"usePicking",tj:"useTexture",pj:"useLabelMapTexture",Zi:"labelmapOpacity",nj:"textureSampler",oj:"textureSampler2",
Aj:"volumeLowerThreshold",Gj:"volumeUpperThreshold",Dj:"volumeScalarMin",Bj:"volumeScalarMax",Ej:"volumeScalarMinColor",Cj:"volumeScalarMaxColor",Ij:"volumeWindowLow",Hj:"volumeWindowHigh",Fj:"volumeTexture"};
function Jf(a){var b=Object.keys(If);Object.keys(Hf).every(function(a){a=Hf[a];return-1!=this.Ad.search(a)||-1!=this.qd.search(a)}.bind(a))||i(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=If[a];return-1!=this.Ad.search(a)||-1!=this.qd.search(a)}.bind(a))||i(Error("Could not find all uniforms in the shader sources."))};function Kf(a,b,c){y(a)||i(Error("Invalid GL Buffer."));y(b)||i(Error("Invalid number of items."));y(c)||i(Error("Invalid item size."));M.call(this);this.c="buffer";this.ia=a;this.yf=b;this.pb=c}H(Kf,M);function Lf(a,b,c,d,e,f,g,h){var l,k=c.offsetParent;if(k){var j="HTML"==k.tagName||"BODY"==k.tagName;if(!j||"static"!=Ze(k,"position"))l=df(k),j||(l=Tc(l,new Sc(k.scrollLeft,k.scrollTop)))}k=df(a);j=gf(a);k=new We(k.x,k.y,j.width,j.height);(j=cf(a))&&k.gg(new We(j.left,j.top,j.right-j.left,j.bottom-j.top));var j=Yd(a),o=Yd(c);if(j.N!=o.N){var v=j.N.body,o=o.N.parentWindow||o.N.defaultView,q=new Sc(0,0),w=$d(v)?$d(v).parentWindow||$d(v).defaultView:window,u=v;do{var B;if(w==o)B=df(u);else{var A=u;
B=new Sc;if(1==A.nodeType)if(A.getBoundingClientRect)A=af(A),B.x=A.left,B.y=A.top;else{var x=le(Yd(A)),A=df(A);B.x=A.x-x.x;B.y=A.y-x.y}else{var x=la(A.th),C=A;A.targetTouches?C=A.targetTouches[0]:x&&A.Ta.targetTouches&&(C=A.Ta.targetTouches[0]);B.x=C.clientX;B.y=C.clientY}}q.x+=B.x;q.y+=B.y}while(w&&w!=o&&(u=w.frameElement)&&(w=w.parent));v=Tc(q,df(v));K&&!ke(j)&&(v=Tc(v,le(j)));k.left+=v.x;k.top+=v.y}a=(b&4&&ef(a)?b^2:b)&-5;b=new Sc(a&2?k.left+k.width:k.left,a&1?k.top+k.height:k.top);l&&(b=Tc(b,
l));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var F;if(g&&(F=cf(c))&&l)F.top-=l.y,F.right-=l.x,F.bottom-=l.y,F.left-=l.x;return Mf(b,c,d,f,F,g,h)}
function Mf(a,b,c,d,e,f,g){var a=a.f(),h=0,l=(c&4&&ef(b)?c^2:c)&-5,c=gf(b),g=g?g.f():c.f();if(d||0!=l)l&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),l&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&h.x+g.width>e.right&&f&16&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y>=e.top&&h.y+g.height>e.bottom&&f&32&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=Ta&&(Ma||Ya)&&ib("1.9");f instanceof Sc?(a=f.x,f=f.y):(a=f,f=m);b.style.left=ff(a,e);b.style.top=ff(f,e);Wc(c,g)||(a=ke(Yd($d(b))),
K&&(!a||!ib("8"))?(c=b.style,a?(K?(a=kf(b,Ye(b,"paddingLeft")),e=kf(b,Ye(b,"paddingRight")),f=kf(b,Ye(b,"paddingTop")),d=kf(b,Ye(b,"paddingBottom")),a=new Ve(f,e,d,a)):(a=Xe(b,"paddingLeft"),e=Xe(b,"paddingRight"),f=Xe(b,"paddingTop"),d=Xe(b,"paddingBottom"),a=new Ve(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),K?(e=mf(b,"borderLeft"),f=mf(b,"borderRight"),d=mf(b,"borderTop"),b=mf(b,"borderBottom"),b=new Ve(d,f,b,e)):(e=Xe(b,"borderLeftWidth"),f=Xe(b,"borderRightWidth"),d=Xe(b,"borderTopWidth"),
b=Xe(b,"borderBottomWidth"),b=new Ve(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Ta?b.MozBoxSizing="border-box":Ua?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return h};function Nf(){}Nf.prototype.Pa=ca();function Of(a,b){this.element=a;this.Pf=b}H(Of,Nf);Of.prototype.Pa=function(a,b,c){Lf(this.element,this.Pf,a,b,m,c)};function Pf(a,b){this.Na=new nf(this);this.ff(a||p);b&&(this.zc=b)}H(Pf,Dc);t=Pf.prototype;t.q=p;t.Yg=n;t.Lf=p;t.oa=r;t.Di=r;t.Te=-1;t.yh=r;t.mh=n;t.zc="toggle_display";t.j=s("q");t.ff=function(a){this.oa&&i(Error("Can not change this state of the popup while showing."));this.q=a};
function Qf(a,b){a.hd&&a.hd.stop();a.$c&&a.$c.stop();if(b){if(!a.oa&&a.$e()){a.q||i(Error("Caller must call setElement before trying to show the popup"));a.Pa();var c=$d(a.q);a.yh&&pf(a.Na,c,"keydown",a.Ph,n);if(a.Yg)if(pf(a.Na,c,"mousedown",a.qg,n),K){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}pf(a.Na,c,"mousedown",a.qg,n);pf(a.Na,c,"deactivate",a.pg)}else pf(a.Na,c,"blur",a.pg);"toggle_display"==
a.zc?(a.q.style.visibility="visible",jf(a.q,n)):"move_offscreen"==a.zc&&a.Pa();a.oa=n;a.hd?(qc(a.hd,"end",a.tg,r,a),a.hd.play()):a.tg()}}else Rf(a)}t.Pa=fa;function Rf(a,b){if(!a.oa||!a.dispatchEvent({type:"beforehide",target:b}))return r;a.Na&&a.Na.Xd();a.$c?(qc(a.$c,"end",ua(a.Of,b),r,a),a.$c.play()):a.Of(b);return n}t.Of=function(a){"toggle_display"==this.zc?this.Di?Cf(this.cg,0,this):this.cg():"move_offscreen"==this.zc&&(this.q.style.left="-200px",this.q.style.top="-200px");this.oa=r;this.af(a)};
t.cg=function(){this.q.style.visibility="hidden";jf(this.q,r)};t.$e=function(){return this.dispatchEvent("beforeshow")};t.tg=function(){this.Te=wa();this.dispatchEvent("show")};t.af=function(a){wa();this.dispatchEvent({type:"hide",target:a})};t.qg=function(a){a=a.target;!je(this.q,a)&&(!this.Lf||je(this.Lf,a))&&!(150>wa()-this.Te)&&Rf(this,a)};t.Ph=function(a){27==a.keyCode&&Rf(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
t.pg=function(a){if(this.mh){var b=$d(this.q);if(K||Sa){if(a=b.activeElement,!a||je(this.q,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>wa()-this.Te||Rf(this)}};t.M=function(){Pf.i.M.call(this);this.Na.La();Tb(this.hd);Tb(this.$c);delete this.q;delete this.Na};function Sf(a,b){this.Ge=a instanceof Sc?a:new Sc(a,b)}H(Sf,Nf);Sf.prototype.Pa=function(a,b,c,d){Lf($e(a),0,a,b,this.Ge,c,p,d)};function Tf(a,b){this.ii=4;this.Wd=b||m;Pf.call(this,a)}H(Tf,Pf);Tf.prototype.Pa=function(){if(this.Wd){var a=!this.oa&&"move_offscreen"!=this.zc,b=this.j();a&&(b.style.visibility="hidden",jf(b,n));this.Wd.Pa(b,this.ii,this.Kj);a&&jf(b,r)}};function Uf(a,b,c){this.Sa=c||(a?Yd(ae(a)):Yd());Tf.call(this,this.Sa.oc("div",{style:"position:absolute;display:none;"}));this.Ie=new Sc(1,1);this.Zb=new Ob;a&&Vf(this,a);if(b!=p)if(a=this.j(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild($d(a).createTextNode(b))}}H(Uf,Tf);var Wf=[];t=Uf.prototype;t.na=p;t.className="goog-tooltip";
t.Bg=500;t.xh=0;t.Ld=s("Sa");function Vf(a,b){b=ae(b);a.Zb.add(b);L(b,"mouseover",a.$f,r,a);L(b,"mouseout",a.Qd,r,a);L(b,"mousemove",a.Zf,r,a);L(b,"focus",a.Yf,r,a);L(b,"blur",a.Qd,r,a)}t.detach=function(a){if(a)a=ae(a),Xf(this,a),this.Zb.remove(a);else{for(var b=this.Zb.Ma(),c=0;a=b[c];c++)Xf(this,a);this.Zb.clear()}};function Xf(a,b){rc(b,"mouseover",a.$f,r,a);rc(b,"mouseout",a.Qd,r,a);rc(b,"mousemove",a.Zf,r,a);rc(b,"focus",a.Yf,r,a);rc(b,"blur",a.Qd,r,a)}
t.ff=function(a){var b=this.j();b&&he(b);Uf.i.ff.call(this,a);a&&(b=this.Sa.N.body,b.insertBefore(a,b.lastChild))};t.$e=function(){if(!Pf.prototype.$e.call(this))return r;if(this.anchor)for(var a,b=0;a=Wf[b];b++)je(a.j(),this.anchor)||Qf(a,r);0<=tb(Wf,this)||Wf.push(this);a=this.j();a.className=this.className;Yf(this);L(a,"mouseover",this.bg,r,this);L(a,"mouseout",this.ag,r,this);Zf(this);return n};
t.af=function(){yb(Wf,this);for(var a=this.j(),b,c=0;b=Wf[c];c++)b.anchor&&je(a,b.anchor)&&Qf(b,r);this.xg&&$f(this.xg);rc(a,"mouseover",this.bg,r,this);rc(a,"mouseout",this.ag,r,this);this.anchor=m;if(0==(this.fb?this.oa?4:1:this.sc?3:this.oa?2:0))this.Yd=r;Pf.prototype.af.call(this)};t.ng=function(a,b){this.anchor==a&&this.Zb.contains(this.anchor)&&(this.Yd||!this.Lj?(Qf(this,r),this.oa||(this.anchor=a,this.Wd=b||ag(this,0)||m,this.oa&&this.Pa(),Qf(this,n))):this.anchor=m);this.fb=m};
t.Lh=function(a){this.sc=m;a==this.anchor&&(this.na==p||this.na!=this.j()&&!this.Zb.contains(this.na))&&(!this.Mf||!this.Mf.na)&&Qf(this,r)};function bg(a,b){var c=le(a.Sa);a.Ie.x=b.clientX+c.x;a.Ie.y=b.clientY+c.y}t.$f=function(a){var b=cg(this,a.target);this.na=b;Yf(this);b!=this.anchor&&(this.anchor=b,this.fb||(this.fb=Cf(ta(this.ng,this,b,m),this.Bg)),dg(this),bg(this,a))};function cg(a,b){try{for(;b&&!a.Zb.contains(b);)b=b.parentNode;return b}catch(c){return p}}
t.Zf=function(a){bg(this,a);this.Yd=n};t.Yf=function(a){this.na=a=cg(this,a.target);this.Yd=n;if(this.anchor!=a){this.anchor=a;var b=ag(this,1);Yf(this);this.fb||(this.fb=Cf(ta(this.ng,this,a,b),this.Bg));dg(this)}};function ag(a,b){if(0==b){var c=a.Ie.f();return new eg(c)}return new fg(a.na)}function dg(a){if(a.anchor)for(var b,c=0;b=Wf[c];c++)je(b.j(),a.anchor)&&(b.Mf=a,a.xg=b)}
t.Qd=function(a){var b=cg(this,a.target),c=cg(this,a.relatedTarget);b!=c&&(b==this.na&&(this.na=p),Zf(this),this.Yd=r,this.oa&&(!a.relatedTarget||!je(this.j(),a.relatedTarget))?$f(this):this.anchor=m)};t.bg=function(){var a=this.j();this.na!=a&&(Yf(this),this.na=a)};t.ag=function(a){var b=this.j();if(this.na==b&&(!a.relatedTarget||!je(b,a.relatedTarget)))this.na=p,$f(this)};function Zf(a){a.fb&&(Bf.clearTimeout(a.fb),a.fb=m)}
function $f(a){if(2==(a.fb?a.oa?4:1:a.sc?3:a.oa?2:0))a.sc=Cf(ta(a.Lh,a,a.anchor),a.xh)}function Yf(a){a.sc&&(Bf.clearTimeout(a.sc),a.sc=m)}t.M=function(){Qf(this,r);Zf(this);this.detach();this.j()&&he(this.j());this.na=p;delete this.Sa;Uf.i.M.call(this)};function eg(a,b){Sf.call(this,a,b)}H(eg,Sf);eg.prototype.Pa=function(a,b,c){b=$e(a);b=cf(b);c=c?new Ve(c.top+10,c.right,c.bottom,c.left+10):new Ve(10,0,0,10);Mf(this.Ge,a,4,c,b,9)&496&&Mf(this.Ge,a,4,c,b,5)};function fg(a){Of.call(this,a,3)}
H(fg,Of);fg.prototype.Pa=function(a,b,c){var d=new Sc(10,0);Lf(this.element,this.Pf,a,b,d,c,9)&496&&Lf(this.element,2,a,1,d,c,5)};function gg(a,b,c,d){y(a)||i(Error("No valid parent element."));(!D(b)||!D(c))&&i(Error("Invalid coordinates."));(!y(d)||!(d instanceof Z))&&i(Error("Invalid interactor."));Uf.call(this);this.c="caption";this.Ca=a;this.Cd=b;this.Dd=c;this.Lb=d;this.ab=p;this.Gb=[];this.Gb=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];qc(d,Ad,this.Rd.bind(this));this.Qe()}H(gg,Uf);
gg.prototype.Qe=function(){if("static"==this.Ca.style.position||""==this.Ca.style.position)this.Ca.style.position="relative";var a=document.getElementsByTagName("head")[0],b=de("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.Gb[0]);a.appendChild(b);b.appendChild(c);this.ab=b;this.Wd=new Sf(this.Cd,this.Dd)||m;this.oa&&this.Pa();Qf(this,n);Vf(this,this.Ca);this.j().classList.add("x-tooltip")};
gg.prototype.Rd=function(){Qf(this,r);this.ab&&he(this.ab);this.j()&&he(this.j());this.ab=p};function Ef(){Df.call(this);this.c="renderer3D";this.Ic=this.Lc=this.Hc=this.Kc=this.Gc=this.Jc=this.re=this.se=p;this.l=[0,0,0];this.Hf=p;this.de=new Kb;this.Pc=new Kb;this.Sc=new Kb;this.oe=new Kb;this.od=new Kb;this.yd=new Kb;this.zd=new Kb;this.xe=new Kb;this.T={PROGRESSBAR_ENABLED:n,PICKING_ENABLED:n,ORDERING_ENABLED:n,STATISTICS_ENABLED:r,INTERMEDIATE_RENDERING:r}}H(Ef,Df);Ef.prototype.__defineGetter__("config",s("T"));t=Ef.prototype;
t.ri=function(){this.Ic=this.Lc=this.Hc=this.Kc=this.Gc=this.Jc=p;this.l=[0,0,0]};t.bf=function(a){Ef.i.bf.call(this,a);var b=a.Cd,a=a.Dd,c=this.get(this.yg(b,a));if(c&&(c=c.gc))(new gg(this.s,this.s.offsetLeft+b+10,this.s.offsetTop+a+10,this.Lb)).j().innerHTML=c};
t.ka=function(){Ef.i.ka.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.K,this.G),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.T.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.K,this.G,0,this.a.RGB,this.a.UNSIGNED_BYTE,p);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.K,this.G);this.a.bindRenderbuffer(this.a.RENDERBUFFER,p);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,
b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,p);this.Hf=a}}catch(d){i(Error("Exception while accessing GL Context!\n"+d))}hg(this)};
function hg(a){var b=new Gf;(!y(a.ha)||!y(a.a)||!y(a.r))&&i(Error("Renderer was not initialized properly."));(!y(b)||!(b instanceof Gf))&&i(Error("Could not add shaders."));Jf(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.qd);a.a.shaderSource(d,b.Ad);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||i(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,a.a.COMPILE_STATUS)||
i(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var e=a.a.createProgram();a.a.attachShader(e,d);a.a.attachShader(e,c);a.a.linkProgram(e);a.a.getProgramParameter(e,a.a.LINK_STATUS)||i(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(e)));a.a.useProgram(e);a.re=e;Object.keys(Hf).forEach(function(a){a=Hf[a];this.de.set(a,this.a.getAttribLocation(this.re,a));this.a.enableVertexAttribArray(this.de.get(a))}.bind(a));
Object.keys(If).forEach(function(a){a=If[a];this.Pc.set(a,this.a.getUniformLocation(this.re,a))}.bind(a));a.se=b}
t.Wa=function(a){Ef.i.Wa.call(this,a);var b=r;this.get(a.pa)&&(b=n);var c=a.pa,d=a.g,e=a.h,f=a.S,g=a.z,h=a.p,l=a.Xb,k=a.X,j=a.n,o=a.t;if(y(j)&&y(j.p)&&j.p.e)this.Wa(j);else if(y(j)&&j.e&&this.Wa(j),y(k)&&y(k.p)&&k.p.e)this.B.load(k,a);else if(y(g)&&y(g.p)&&g.p.e)this.B.load(g,a);else{if(y(h)&&z(h))if(y(a.ec)){if(a.ec.Sd!=h.length||!a.e)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.B.load(h[b],a);return}else{if(y(h)&&h.e){this.B.load(a,a);return}if(y(o)&&y(o.p)&&o.p.e){this.B.load(o,a);return}}if(0<
a.d.length){h=a.d;k=h.length;for(j=j=0;j<k;j++)this.Wa(h[j])}if(d){for(h=0;this.ud;)h++,window.console.log("Possible thread lock avoided: "+h);this.ud=n;k=a instanceof oe&&a.bb instanceof qe;b&&y(g)&&g.e&&(h=this.zd.get(c),y(h)&&this.a.isBuffer(h.ia)&&this.a.deleteBuffer(h.ia));h=p;y(g)&&(!b||g.e?(h=a.Wb,y(h)||i(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),j=r,g.sa&&(j=n),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,j),j=this.a.createTexture(),
j.Ah=g.lb,this.xe.set(g.pa,j),this.a.bindTexture(this.a.TEXTURE_2D,j),g.sa?this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,g.yb,g.xb,0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.sa):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,j.Ah),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),k?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),
this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,p),j=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new Kf(j,h.length,2),g.e=r):h=this.zd.get(c));Fe(this.B,0.1);if(k)this.ud=
r,I.Aa(this.c+".update"),Fe(this.B,0.9);else{if(!b||d.e||l.e){k=l.C;g=k.Oa(new O(d.Pb,d.Qb,d.Rb));k=k.Oa(new O(d.Mb,d.Nb,d.Ob));if(this.Jc===p||g.x<this.Jc)this.Jc=g.x;if(this.Gc===p||k.x>this.Gc)this.Gc=k.x;if(this.Kc===p||g.y<this.Kc)this.Kc=g.y;if(this.Hc===p||k.y>this.Hc)this.Hc=k.y;if(this.Lc===p||g.b<this.Lc)this.Lc=g.b;if(this.Ic===p||k.b>this.Ic)this.Ic=k.b;this.l=[(this.Jc+this.Gc)/2,(this.Kc+this.Hc)/2,(this.Lc+this.Ic)/2];l.e=r}b&&d.e&&(l=this.Sc.get(c),y(l)&&this.a.isBuffer(l.ia)&&this.a.deleteBuffer(l.ia));
l=p;!b||d.e?(l=this.a.createBuffer(),d.yc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,l),this.a.bufferData(this.a.ARRAY_BUFFER,d.I,this.a.STATIC_DRAW),l=new Kf(l,d.count,3),d.e=r):l=this.Sc.get(c);Fe(this.B,0.3);b&&e.e&&(g=this.Sc.get(c),y(g)&&this.a.isBuffer(g.ia)&&this.a.deleteBuffer(g.ia));g=p;!b||e.e?(g=this.a.createBuffer(),e.yc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,e.I,this.a.STATIC_DRAW),g=new Kf(g,e.count,3),e.e=r):g=this.oe.get(c);Fe(this.B,0.3);b&&
f&&f.e&&(e=this.od.get(c),y(e)&&this.a.isBuffer(e.ia)&&this.a.deleteBuffer(e.ia));e=p;f&&(!b||f.e?(f.length!=d.length&&i(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),f.yc(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f.I,this.a.STATIC_DRAW),e=new Kf(e,f.count,3),f.e=r):e=this.od.get(c));Fe(this.B,0.2);b&&o&&o.e&&(f=this.yd.get(c),y(f)&&this.a.isBuffer(f.ia)&&this.a.deleteBuffer(f.ia));f=p;o&&(f=o.Bc,!b||o.e?(f.length!=d.length&&i(Error("Mismatch between points and scalars.")),
d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Kf(d,f.length,3),o.e=r):f=this.yd.get(c));Fe(this.B,0.1);b||this.Za.add(a);this.Sc.set(c,l);this.oe.set(c,g);this.od.set(c,e);this.zd.set(c,h);this.yd.set(c,f);this.ud=a.e=r}}else a.e=r}};
function ig(a,b){var c=new O(1,0,0),c=a.r.m.Oa(c),d=Pc(a.r.ra,c),c=new O(-1,0,0),c=a.r.m.Oa(c),e=Pc(a.r.ra,c),c=new O(0,1,0),c=a.r.m.Oa(c),f=Pc(a.r.ra,c),c=new O(0,-1,0),c=a.r.m.Oa(c),g=Pc(a.r.ra,c),c=new O(0,0,1),c=a.r.m.Oa(c),h=Pc(a.r.ra,c),c=new O(0,0,-1),c=a.r.m.Oa(c),c=Pc(a.r.ra,c),l=Math.max(d,f,h,e,g,c);l==d||l==e?pe(b,0):l==f||l==g?pe(b,1):(l==h||l==c)&&pe(b,2)}function jg(a,b){var c=b.g.nd,c=a.r.m.Oa(b.Xb.C.Oa(new O(c[0],c[1],c[2]))),c=Pc(a.r.ra,c);return Math.round(1E3*c)/1E3}
t.yg=function(a,b){if(this.T.PICKING_ENABLED){this.Cb(n,r);var c=new Uint8Array(4);this.a.readPixels(a,this.G-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
t.Cb=function(a,b){Ef.i.Cb.call(this,a,b);if(0!=this.Za.u.length){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.Hf):this.a.bindFramebuffer(this.a.FRAMEBUFFER,p);this.a.viewport(0,0,this.K,this.G);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var c=this.r.Gf,d=this.r.Jb;this.a.uniformMatrix4fv(this.Pc.get("perspective"),r,c);this.a.uniformMatrix4fv(this.Pc.get("view"),r,d);c=this.l;this.a.uniform3f(this.Pc.get("center"),parseFloat(c[0]),parseFloat(c[1]),parseFloat(c[2]));c=this.Ia.length;
for(d=0;d<c;++d){var e=this.Ia[d];if(e instanceof N)ig(this,e);else if(e instanceof kg&&(e.rd++,e.Xa&&e.Xa instanceof N&&e.Xa.Af&&ig(this,e.Xa),e.rd==e.ve&&e.ce)){1<=e.hc&&(e.d[e.hc-1].ma=r);e.hc>e.d.length-1&&(e.hc=0);var f=e.d[e.hc];f.ma=n;e.Xa=f;e.hc++;e.rd=0}}if(this.T.ORDERING_ENABLED){var g=r,e=this.Ia,f=e.length-1;do if(d=e[f],d instanceof kg&&(d=d.Xa),d instanceof N&&d.Ja){var h=d.Ab,g=d.O.d;1==h?g=d.P.d:2==h&&(g=d.$a.d);var h=g.length,l=g[0];l.U=jg(this,l);l.V=d.V;var k=g[h-1];k.U=jg(this,
k);k.V=d.V;for(var k=Math.round(1E3*((k.U-l.U)/h))/1E3,j=1,j=1;j<h-1;j++){var o=Math.round(1E3*(l.U+j*k))/1E3;g[j].U=o;g[j].V=d.V}g=n}while(f--);e=this.Za.u;f=e.length-1;do if(d=e[f],d.ma&&!(1==d.V||d instanceof oe))d.U=jg(this,d),g=n;while(f--);g&&this.Za.sort()}d=c;do lg(this,this.Ia[c-d],a);while(--d)}};
function lg(a,b,c){if(b&&b.ma){if(b.g){var d=a.de,e=d.get("vertexPosition"),f=d.get("vertexNormal"),g=d.get("vertexColor"),h=d.get("vertexTexturePos"),l=d.get("vertexScalar"),d=a.Pc,k=d.get("usePicking"),j=d.get("useObjectColor"),o=d.get("objectColor"),v=d.get("useScalars"),q=d.get("scalarsReplaceMode"),w=d.get("scalarsMin"),u=d.get("scalarsMax"),B=d.get("scalarsMinColor"),A=d.get("scalarsMaxColor"),x=d.get("scalarsMinThreshold"),C=d.get("scalarsMaxThreshold"),F=d.get("objectOpacity"),G=d.get("labelmapOpacity"),
P=d.get("useTexture"),Q=d.get("useLabelMapTexture"),J=d.get("textureSampler"),T=d.get("textureSampler2"),ba=d.get("volumeLowerThreshold"),aa=d.get("volumeUpperThreshold"),va=d.get("volumeScalarMin"),lb=d.get("volumeScalarMax"),Ea=d.get("volumeWindowLow"),wc=d.get("volumeWindowHigh"),dd=d.get("volumeScalarMinColor"),mb=d.get("volumeScalarMaxColor"),xc=d.get("volumeTexture"),Cb=d.get("objectTransform"),eb=d.get("pointSize"),ga=p;b instanceof oe&&b.bb&&(ga=b.bb);var Fa=b.pa,sa=b.Fc,d=a.Sc.get(Fa),db=
a.oe.get(Fa),Wb=a.od.get(Fa),Vb=a.yd.get(Fa),Rd=a.zd.get(Fa);a.a.bindBuffer(a.a.ARRAY_BUFFER,d.ia);a.a.vertexAttribPointer(e,d.pb,a.a.FLOAT,r,0,0);a.a.bindBuffer(a.a.ARRAY_BUFFER,db.ia);a.a.vertexAttribPointer(f,db.pb,a.a.FLOAT,r,0,0);c?a.a.uniform1i(k,n):a.a.uniform1i(k,r);Wb&&!c&&!sa?(a.a.uniform1i(j,r),a.a.bindBuffer(a.a.ARRAY_BUFFER,Wb.ia),a.a.vertexAttribPointer(g,Wb.pb,a.a.FLOAT,r,0,0)):(e=1,sa&&!c&&(e=0),a.a.uniform1i(j,e),e=b.Fb,c&&(e=[Math.floor(Fa%65025%255)/255,Math.floor(Fa%65025/255)/
255,Math.floor(Fa/65025)/255]),a.a.uniform3f(o,parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2])),a.a.vertexAttribPointer(g,d.pb,a.a.FLOAT,r,0,0));Vb&&!c&&!sa?(a.a.uniform1i(v,n),a.a.uniform1i(q,b.t.Jf),g=b.t.tb,o=b.t.rb,a.a.uniform3f(B,parseFloat(g[0]),parseFloat(g[1]),parseFloat(g[2])),a.a.uniform3f(A,parseFloat(o[0]),parseFloat(o[1]),parseFloat(o[2])),a.a.uniform1f(x,parseFloat(b.t.ba)),a.a.uniform1f(C,parseFloat(b.t.ca)),a.a.uniform1f(w,parseFloat(b.t.Ha)),a.a.uniform1f(u,parseFloat(b.t.Ba)),
a.a.bindBuffer(a.a.ARRAY_BUFFER,Vb.ia),a.a.vertexAttribPointer(l,Vb.pb,a.a.FLOAT,r,0,0)):(a.a.uniform1i(v,r),a.a.vertexAttribPointer(l,d.pb,a.a.FLOAT,r,0,0));a.a.uniform1f(F,parseFloat(b.V));b.z&&Rd&&!c?(a.a.uniform1i(P,n),a.a.activeTexture(a.a.TEXTURE0),a.a.bindTexture(a.a.TEXTURE_2D,a.xe.get(b.z.pa)),a.a.uniform1i(J,0),a.a.bindBuffer(a.a.ARRAY_BUFFER,Rd.ia),a.a.vertexAttribPointer(h,Rd.pb,a.a.FLOAT,r,0,0),a.a.uniform1i(xc,r)):(a.a.uniform1i(P,r),a.a.vertexAttribPointer(h,d.pb,a.a.FLOAT,r,0,0));
ga&&(a.a.uniform1i(xc,n),a.a.uniform1f(ba,ga.ba),a.a.uniform1f(aa,ga.ca),a.a.uniform1f(va,ga.Ha),a.a.uniform1f(lb,ga.Ba),g=ga.tb,o=ga.rb,a.a.uniform3f(dd,parseFloat(g[0]),parseFloat(g[1]),parseFloat(g[2])),a.a.uniform3f(mb,parseFloat(o[0]),parseFloat(o[1]),parseFloat(o[2])),a.a.uniform1f(Ea,ga.ea),a.a.uniform1f(wc,ga.da),h=ga.n,a.a.uniform1i(Q,r),ga.Ja?a.a.uniform1f(F,parseFloat(ga.V)):h&&h.ma&&(F=b.n.pa,a.a.uniform1i(Q,n),a.a.activeTexture(a.a.TEXTURE1),a.a.bindTexture(a.a.TEXTURE_2D,a.xe.get(F)),
a.a.uniform1i(T,1),a.a.uniform1f(G,h.V)));a.a.uniformMatrix4fv(Cb,r,b.Xb.xf);G=1;"POINTS"==b.ja&&(G=b.Nc);a.a.uniform1f(eb,G);G=-1;b.ja==jd?G=a.a.TRIANGLES:"LINES"==b.ja?(a.a.lineWidth(b.mc),G=a.a.LINES):"POINTS"==b.ja?G=a.a.POINTS:"TRIANGLE_STRIPS"==b.ja?G=a.a.TRIANGLE_STRIP:"POLYGONS"==b.ja&&(G=0==d.yf%3?a.a.TRIANGLES:a.a.TRIANGLE_FAN);a.a.drawArrays(G,0,d.yf)}b=b.d;d=b.length;for(G=G=0;G<d;G++)lg(a,b[G],c)}}
t.Jd=function(){this.se=p;delete this.se;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);Ef.i.Jd.call(this)};E("X.renderer3D",Ef);E("X.renderer3D.prototype.init",Ef.prototype.ka);E("X.renderer3D.prototype.add",Ef.prototype.add);E("X.renderer3D.prototype.onShowtime",Ef.prototype.ug);E("X.renderer3D.prototype.onRender",Ef.prototype.sg);E("X.renderer3D.prototype.get",Ef.prototype.get);E("X.renderer3D.prototype.render",Ef.prototype.dc);E("X.renderer3D.prototype.destroy",Ef.prototype.Jd);
E("X.renderer3D.prototype.resetBoundingBox",Ef.prototype.ri);E("X.renderer3D.prototype.resetViewAndRender",Ef.prototype.xc);E("X.renderer3D.prototype.pick",Ef.prototype.yg);function kg(){V.call(this);this.c="animation";this.ve=1;this.ce=n;this.hc=0;this.Xa=p;this.rd=0}H(kg,V);kg.prototype.__defineGetter__("speed",s("ve"));kg.prototype.__defineSetter__("speed",function(a){this.rd=0;this.ve=Math.floor(a)});kg.prototype.__defineGetter__("active",s("ce"));kg.prototype.__defineSetter__("active",da("ce"));kg.prototype.__defineGetter__("currentObject",s("Xa"));kg.prototype.add=function(a){a.ma=r;this.Xa||(this.Xa=a,a.ma=n);this.d.push(a)};E("X.animation",kg);
E("X.animation.prototype.add",kg.prototype.add);function $(){Df.call(this);this.c="renderer2D";this.zf=this.ge=this.wf=this.fe=this.ub=p;this.xd=this.Tb=this.Ub=this.te=this.ue=0}H($,Df);$.prototype.di=ca();$.prototype.ei=ca();$.prototype.cf=function(a){$.i.cf.call(this,a);var b=this.Ia[0];if(b){var c=this.ub;b["index"+c]=a.J?b["index"+c]+1:b["index"+c]-1;eval("this.onScroll();")}};
$.prototype.fi=function(a){var b=this.Ia[0];if(b){var c=b.da-b.ea,d=c/2,e=parseInt(c+c/15*-a.ze,10),a=parseInt(d+d/15*a.le,10);c==e&&e++;d==a&&a++;b.ea-=parseInt(d-a,10);b.ea-=parseInt(c-e,10);b.ea=Math.max(b.ea,b.Ha);b.da-=parseInt(d-a,10);b.da+=parseInt(c-e,10);b.da=Math.min(b.da,b.Ba);eval("this.onWindowLevel();")}};$.prototype.__defineGetter__("orientation",s("ub"));
$.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"X"!=a&&"Y"!=a&&"Z"!=a&&i(Error("Invalid orientation."));this.ub=a});t=$.prototype;t.ka=function(){this.ub||i(Error("No 2D orientation set."));$.i.ka.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.ha.width,this.ha.height);this.fe=de("canvas");this.ge=de("canvas");L(this.r,xd,this.fi.bind(this))};t.rotate=function(){this.xd++};t.si=function(){this.xd--};
t.xc=function(){$.i.xc.call(this);mg(this);var a=this.Ia[0];a&&(a.da=a.Ba,a.ea=a.Ha)};
t.Wa=function(a){$.i.Wa.call(this,a);var b=r;this.get(a.pa)&&(b=n);var c=a.p,d=a.n,e=a.X;if(y(d)&&y(d.p)&&d.p.e)this.Wa(d);else if(y(e)&&y(e.p)&&e.p.e)this.B.load(e,a);else{if(y(c)&&z(c))if(y(a.ec)){if(a.ec.Sd!=c.length||b&&!a.e)return}else{b=0;d=c.length;for(b=0;b<d;b++)this.B.load(c[b],a);return}else if(y(c)&&c.e){this.B.load(a,a);return}var d=c=0,e=a.Y,f=a.H;"X"==this.ub?(this.Vb=a.O.d,c=e[1],d=e[2],this.Ub=f[1],this.Tb=f[2]):"Y"==this.ub?(this.Vb=a.P.d,c=e[0],d=e[2],this.Ub=f[0],this.Tb=f[2]):
"Z"==this.ub&&(this.Vb=a.$a.d,c=e[0],d=e[1],this.Ub=f[0],this.Tb=f[1]);this.ue=c;this.te=d;e=this.fe;e.width=c;e.height=d;f=this.ge;f.width=c;f.height=d;this.wf=e.getContext("2d");this.zf=f.getContext("2d");b||(this.Za.add(a),mg(this))}};function mg(a){a.r.m.k(2,3,Math.min(a.K/(a.ue*a.Ub),a.G/(a.te*a.Tb)))}
t.Cb=function(a,b){$.i.Cb.call(this,a,b);if(0!=this.Za.u.length){var c=this.K,d=this.G,e=this.r.m;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.R(0,3),g=-1*e.R(1,3),h=Math.max(e.R(2,3),0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.Ia[0],l=this.Vb[parseInt(e["index"+this.ub],10)],k=l.z.sa,l=l.n,j=p;l&&(j=l.sa);var o=this.ue,v=this.te,q=this.wf,w=this.zf,u=q.getImageData(0,0,o,v),B=w.getImageData(0,0,o,v),A=u.data,x=B.data,C=A.length,F=e.Ba,G=e.ba,P=e.ca,Q=0;do{var J=[0,
0,0,0],T=[0,0,0,0],ba=k[Q]/255*F,aa=k[Q],va=e.ea/F,aa=(aa/255-va)/(e.da/F-va),aa=255*aa;ba>=G&&ba<=P&&(J=new O(e.tb[0],e.tb[1],e.tb[2]),J=(new O(e.rb[0],e.rb[1],e.rb[2])).scale(aa).add(J.scale(255-aa)),J=[Math.floor(J.x),Math.floor(J.y),Math.floor(J.b),255],l&&(T=[j[Q],j[Q+1],j[Q+2],j[Q+3]]));aa=C-1-Q;A[aa-3]=J[0];A[aa-2]=J[1];A[aa-1]=J[2];A[aa]=J[3];x[aa-3]=T[0];x[aa-2]=T[1];x[aa-1]=T[2];x[aa]=T[3];Q+=4}while(Q<C);q.putImageData(u,0,0);w.putImageData(B,0,0);this.a.globalAlpha=1;this.a.translate(c/
2/h,d/2/h);this.a.rotate(0.5*Math.PI*this.xd);switch(this.xd%4){case 1:c=f;f=g;g=-c;break;case 2:f*=-1;g*=-1;break;case 3:c=f,f=-g,g=c}f=-o*this.Ub/2+f;g=-v*this.Tb/2+g;this.a.drawImage(this.fe,f,g,o*this.Ub,v*this.Tb);l&&e.n.ma&&(this.a.globalAlpha=e.n.V,this.a.drawImage(this.ge,f,g,o*this.Ub,v*this.Tb))}};E("X.renderer2D",$);E("X.renderer2D.prototype.init",$.prototype.ka);E("X.renderer2D.prototype.add",$.prototype.add);E("X.renderer2D.prototype.onShowtime",$.prototype.ug);
E("X.renderer2D.prototype.onRender",$.prototype.sg);E("X.renderer2D.prototype.onScroll",$.prototype.di);E("X.renderer2D.prototype.onWindowLevel",$.prototype.ei);E("X.renderer2D.prototype.get",$.prototype.get);E("X.renderer2D.prototype.rotate",$.prototype.rotate);E("X.renderer2D.prototype.rotateCounter",$.prototype.si);E("X.renderer2D.prototype.resetViewAndRender",$.prototype.xc);E("X.renderer2D.prototype.render",$.prototype.dc);E("X.renderer2D.prototype.destroy",$.prototype.Jd);function ng(){V.call(this);this.c="fibers";ya(this,new Mc)}H(ng,V);E("X.fibers",ng);function og(){V.call(this);this.c="mesh";ya(this,new Mc)}H(og,V);E("X.mesh",og);
